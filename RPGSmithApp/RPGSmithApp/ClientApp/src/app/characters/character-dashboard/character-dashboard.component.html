<div class="page-character-dashboard">
  <!-- Toolbar -->
  <div class="page-toolbar">
    <div class="container">

      <div class="page-toolbar-wrapper initial show">
        <div class="page-toolbar-dropdowns">
          <!-- Layout dropdown -->
          <div class="dropdown" [ngClass]="{'show': isLayoutDropdownOpen}">
            <div class="dropdown-toggle is-layout-show" id="layoutNavigationToggle">
              <span class="is-layout-show"><span class="d-none d-md-inline-block">Layout</span> <span class="d-md-none">L</span> <em *ngIf="selectedlayout">{{selectedlayout.name}}</em> </span>
            </div>
            <div infiniteScroll (scrolled)="onLayoutScroll()" [infiniteScrollDistance]="1"
                 [infiniteScrollThrottle]="100" [scrollWindow]="false" [class]="foldClass" aria-labelledby="pageLayoutNavigationToggle" *ngIf="isLayoutDropdownOpen && !isLoading">
              <div class="dropdown-menu-add-item-trigger">
                <button (click)="newLayout()" type="button" class="btn btn-accent btn-block">New Layout</button>
              </div>
              <div class="web-view" [dragula]='"bag-characterDashboardLayout"' [dragulaModel]="characterlayouts">
                <ul class="dropdown-menu-list dropdown-menu-item-contain-actions" *ngFor="let layout of characterlayouts" [attr.id]="layout.characterDashboardLayoutId">
                  <li class="dropdown-menu-item" [ngClass]="{'active': selectedlayout.characterDashboardLayoutId == layout.characterDashboardLayoutId}">
                    <span (click)="onLayoutSelect(layout)" class="dropdown-menu-item-title layout-spacing">{{layout.name}}</span>
                    <div class="dropdown-menu-item-actions show" *ngIf="layout?.showIcon">
                      <button type="button" (click)="editLayout(layout)" title="Edit" data-toggle="tooltip" data-action="edit" class="btn icon icon-pencil btn-simple-primary"></button>
                      <button type="button" (click)="duplicateLayout(layout)" tooltip="Duplicate" class="btn icon icon-copy icon-rsi btn-simple-primary"></button>
                      <button type="button" (click)="deleteLayout(layout)" title="Delete" data-toggle="tooltip" data-action="delete" class="btn icon icon-trash btn-simple-primary"></button>
                      <button type="button" (click)="manageIcon('0')" title="Close" data-toggle="tooltip" data-action="close" class="btn icon icon-cross btn-simple-primary show-layout-drp"></button>
                    </div>
                    <div class="dropdown-menu-item-actions-trigger showdrp">
                      <button type="button" *ngIf="!layout?.showIcon && layout.characterDashboardLayoutId != -1" (click)="manageIcon(layout.characterDashboardLayoutId)" title="Manage" data-toggle="tooltip" class="btn icon icon-more btn-simple-primary show-layout-drp"></button>
                    </div>
                  </li>

                </ul>
              </div>
              <div class="mob-view">
                <ul class="dropdown-menu-list dropdown-menu-item-contain-actions" *ngFor="let layout of characterlayouts" [attr.id]="layout.characterDashboardLayoutId">
                  <li class="dropdown-menu-item" [ngClass]="{'active': selectedlayout.characterDashboardLayoutId == layout.characterDashboardLayoutId}">
                    <span (click)="onLayoutSelect(layout)" class="dropdown-menu-item-title layout-spacing">{{layout.name}}</span>
                    <div class="dropdown-menu-item-actions show" *ngIf="layout?.showIcon">
                      <button type="button" (click)="editLayout(layout)" title="Edit" data-toggle="tooltip" data-action="edit" class="action-buttons-left btn icon icon-pencil btn-simple-primary"></button>
                      <button type="button" (click)="duplicateLayout(layout)" tooltip="Duplicate" class=" btn icon icon-copy icon-rsi btn-simple-primary"></button>
                      <button type="button" (click)="deleteLayout(layout)" title="Delete" data-toggle="tooltip" data-action="delete" class="action-buttons-left btn icon icon-trash btn-simple-primary"></button>
                      <button type="button" (click)="manageIcon('0')" title="Close" data-toggle="tooltip" data-action="close" class="action-buttons-left btn icon icon-cross btn-simple-primary show-layout-drp"></button>
                    </div>
                    <div class="dropdown-menu-item-actions-trigger showdrp">
                      <div class="card-actions action-buttons-left sorting-up-arrow" (click)="scrollUp(layout,false,this)">
                        <i class="fa fa-arrow-up"></i>
                      </div>
                      <div class="card-actions action-buttons-left sorting-down-arrow" (click)="scrollDown(layout,false,this)">
                        <i class="fa fa-arrow-down"></i>
                      </div>
                      <button type="button" *ngIf="!layout?.showIcon && layout.characterDashboardLayoutId != -1" (click)="manageIcon(layout.characterDashboardLayoutId)" title="Manage" data-toggle="tooltip" class="action-buttons-left btn icon icon-more btn-simple-primary show-layout-drp"></button>
                    </div>

                  </li>

                </ul>
              </div>
            </div>
          </div>
          <!-- End of layout dropdown -->
          <!-- Action menu-->
          <div class="page-toolbar-wrapper-toggle-trigger">
            <button type="button" class="btn icon icon-with-text btn-accent" (click)="showActionButtons(showActions)"
                    [ngClass]="{'icon-arrow-up' : showActions,  'icon-arrow-down' : !showActions}">
              {{actionText}}
            </button>
          </div>
          <!-- End of Action menu-->
          <!-- Page dropdown -->
          <div class="dropdown" [ngClass]="{'show': isPageDropdownOpen}">
            <div class="dropdown-toggle is-page-show" id="pageNavigationToggle">
              <span class="is-page-show"><span class="d-none d-md-inline-block">Page</span> <span class="d-md-none">P</span> <em *ngIf="selectedPage && !isLoading">{{selectedPage.name}}</em></span>
            </div>
            <div [class]="pagedrpClass" aria-labelledby="pageLayoutNavigationToggle" *ngIf="isPageDropdownOpen && selectedlayout && !isLoading">
              <div class="dropdown-menu-add-item-trigger" *ngIf="!isSharedLayout">
                <button type="button" (click)="newPage()" class="btn btn-accent btn-block">New Page</button>
              </div>
              <div class="web-view" [dragula]='"bag-characterDashboardPages"' [dragulaModel]="selectedlayout.characterDashboardPages">
                <ul class="dropdown-menu-list dropdown-menu-item-contain-actions" *ngFor="let page of selectedlayout?.characterDashboardPages" [attr.id]="page?.characterDashboardPageId">
                  <li class="dropdown-menu-item" [ngClass]="{'active': selectedPage?.characterDashboardPageId == page?.characterDashboardPageId}">
                    <span (click)="onPageSelect(page)" class="dropdown-menu-item-title layout-spacing">{{page.name}}</span>
                    <div class="dropdown-menu-item-actions show" *ngIf="page?.showIcon">
                      <button (click)="editPage(page)" type="button" title="Edit" data-toggle="tooltip" data-action="edit" class="btn icon icon-pencil btn-simple-primary"></button>
                      <button (click)="duplicatePage(page)" type="button" tooltip="Duplicate" class=" btn icon icon-copy icon-rsi btn-simple-primary"></button>
                      <button (click)="deletePage(page)" type="button" title="Delete" data-toggle="tooltip" data-action="delete" class="btn icon icon-trash btn-simple-primary"></button>
                      <button (click)="managePageIcon(0)" type="button" title="Close" data-toggle="tooltip" data-action="close" class="btn icon icon-cross btn-simple-primary show-page-drp"></button>
                    </div>
                    <div class="dropdown-menu-item-actions-trigger">
                      <button type="button" *ngIf="!page?.showIcon && !isSharedLayout" (click)="managePageIcon(page?.characterDashboardPageId)" title="Manage" data-toggle="tooltip" class="btn icon icon-more btn-simple-primary show-page-drp"></button>
                    </div>
                  </li>

                </ul>
              </div>
              <div class="mob-view">
                <ul class="dropdown-menu-list dropdown-menu-item-contain-actions" *ngFor="let page of selectedlayout?.characterDashboardPages" [attr.id]="page?.characterDashboardPageId">
                  <li class="dropdown-menu-item" [ngClass]="{'active': selectedPage == page}">
                    <span (click)="onPageSelect(page)" class="dropdown-menu-item-title layout-spacing">{{page.name}}</span>
                    <div class="dropdown-menu-item-actions show" *ngIf="page?.showIcon">
                      <button (click)="editPage(page)" type="button" title="Edit" data-toggle="tooltip" data-action="edit" class="action-buttons-left btn icon icon-pencil btn-simple-primary"></button>
                      <button (click)="duplicatePage(page)" type="button" tooltip="Duplicate" class=" btn icon icon-copy icon-rsi btn-simple-primary"></button>
                      <button (click)="deletePage(page)" type="button" title="Delete" data-toggle="tooltip" data-action="delete" class="action-buttons-left btn icon icon-trash btn-simple-primary"></button>
                      <button (click)="managePageIcon(0)" type="button" title="Close" data-toggle="tooltip" data-action="close" class="action-buttons-left btn icon icon-cross btn-simple-primary show-page-drp"></button>
                    </div>
                    <div class="dropdown-menu-item-actions-trigger">
                      <div class=" action-buttons-left card-actions sorting-up-arrow" (click)="scrollUp(page,true,this)">
                        <i class="fa fa-arrow-up"></i>
                      </div>
                      <div class="card-actions action-buttons-left sorting-down-arrow" (click)="scrollDown(page,true,this)">
                        <i class="fa fa-arrow-down"></i>
                      </div>
                      <button type="button" *ngIf="!page?.showIcon && !isSharedLayout" (click)="managePageIcon(page?.characterDashboardPageId)" title="Manage" data-toggle="tooltip" class=" action-buttons-left btn icon icon-more btn-simple-primary show-page-drp"></button>
                    </div>
                  </li>

                </ul>
              </div>
            </div>
          </div>
          <!-- End of page dropdown -->
        </div>

        <!-- Toolbar links -->
        <ul class="page-toolbar-links" [ngClass]="{'d-none d-md-flex' : !showActions}" *ngIf="!isLoading">
          <li *ngIf="rulesetModel?.isItemEnabled">
            <a (click)="manageRoute(charNav?.items, 'false')" class="btn btn-link-primary icon-Gen-Items"
               [ngClass]="{'navigationIsContainingAllies':doesCharacterHasAllies}" popover="{{doesCharacterHasAllies ? 'Inventory' : ''}}" triggers="hover"><span>Inventory</span></a>
          </li>
          <li *ngIf="rulesetModel?.isSpellEnabled">
            <a (click)="manageRoute(charNav?.spells, 'false')" class="btn btn-link-primary icon-Rec-Magical"
               [ngClass]="{'navigationIsContainingAllies':doesCharacterHasAllies}" popover="{{doesCharacterHasAllies ? 'Spells' : ''}}" triggers="hover"><span>Spells</span></a>
          </li>
          <li *ngIf="rulesetModel?.isAbilityEnabled">
            <a (click)="manageRoute(charNav?.abilities, 'false')" class="btn btn-link-primary icon-Gen-Ability"
               [ngClass]="{'navigationIsContainingAllies':doesCharacterHasAllies}" popover="{{doesCharacterHasAllies ? 'Abilities' : ''}}" triggers="hover"><span>Abilities</span></a>
          </li>
          <li *ngIf="doesCharacterHasAllies">
            <a (click)="GoToAllies()" class="btn btn-link-primary icon-Ally ally_icon"
               [ngClass]="{'navigationIsContainingAllies':doesCharacterHasAllies}" popover="{{doesCharacterHasAllies ? 'Allies' : ''}}" triggers="hover"><span>Allies</span></a>
          </li>
          <li *ngIf="rulesetModel">
            <a (click)="manageRoute('character/character-stats')" class="btn btn-link-primary icon-Gen-CharStat"
               [ngClass]="{'navigationIsContainingAllies':doesCharacterHasAllies}" popover="{{doesCharacterHasAllies ? 'Character Stats' : ''}}" triggers="hover"><span>Character Stats</span></a>
          </li>
        </ul>
        <!-- End of toolbar links -->
        <!-- Toolbar actions -->
        <ul class="page-toolbar-actions" [ngClass]="{'d-none d-md-flex' : !showActions}">
          <li>
            <button *ngIf="!isSharedLayout" [disabled]="isLoading" type="button" id="manageTilesTrigger" class="btn btn-outline-primary icon-Gen-Edit" (click)="checkTile('character/tiles',selectedPage?.characterDashboardPageId,selectedlayout.characterDashboardLayoutId)"> Manage Tiles</button>
          </li>
          <li class="refresh-btn" *ngIf="pageRefresh">
            <button type="button" class="btn btn-outline-primary icon icon-Gen-Refresh" (click)="refresh()"></button>
          </li>
          <!--<li>
                <button type="button" data-toggle="modal" data-target="#manageCoreStatsPopup" class="btn btn-outline-primary">Manage Core Stats</button>
            </li>-->
          <li>
            <button type="button" (click)="openDiceRollModal()" class="btn icon icon-with-text icon-dice icon-rsi btn-primary">Dice</button>
          </li>
        </ul>
        <!-- End of toolbar actions -->
      </div>

      <div class="page-toolbar-wrapper manage">
        <div class="page-toolbar-title">
          <h1>Manage Tiles</h1>
        </div>
        <ul class="page-toolbar-actions">
          <li class="popup-new-tile-trigger">
            <button type="button" data-toggle="modal" data-target="#newTilePopup" class="btn icon icon-plus btn-primary"></button>
          </li>
          <li>
            <button type="button" id="manageTilesDoneTrigger" class="btn btn-accent">Done</button>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <!-- End of toolbar -->
  <!-- Tiles -->
  <div class="tiles">

    <div style="display:inline;" *ngIf="selectedlayout?.characterDashboardPages?.length>1">
      <button type="button" class="btn icon icon-with-text prev-button icon-Gen-BackArrow"
              (click)="NextPrevPage(selectedlayout,false)"></button>
      <button type="button" class="btn icon icon-with-text next-button icon-Gen-BackArrow"
              (click)="NextPrevPage(selectedlayout,true)"></button>
    </div>


    <div class="container height-fixed-grid  page-item-details" *ngIf="!isLoading
         && !isInventoryLoading
         && !isRulesetViewInventoryLoading
         && !isAlliesLoading
         && !isAbilitiesLoading
         && !isRulesetViewAbilityLoading
         && !isSpellsLoading
         && !isRulesetSpellsLoading
         && !isLootLoading">
      <p class="text-center py-5 w-100 d-block" *ngIf="noRecordFound">No Tiles have been added to this character. Click "Manage Tiles" to add some.</p>
      <div [ngGrid]="gridConfig">

        <div *ngFor="let box of boxes; let i = index" [(ngGridItem)]="box.config">

          <!--<div *ngIf="box.IsCharacter">
              <div class="tiles manage character handle">
                  <div class="tile-group tile-group-item_counts ">
                      <div class="tile tile-type-image tile-color-6">
                          <h5 class="tile-title" popover="{{character.characterName}}" triggers="hover">{{character.characterName}}</h5>
                          <div class="tile-body">
                              <img [src]="character.imageUrl" [alt]="character.characterName"
                                   onerror="this.src = '../assets/images/DefaultImages/Character.jpg';">
                          </div>

                      </div>
                  </div>
              </div>
          </div>-->
          <div *ngIf="!box.IsCharacter">
            <div class="tiles manage colwidth handle">

              <div class="tile-group tile-group-item_counts" *ngIf="box.tile.tileTypeId==TILES.NOTE && box.tile.noteTiles" [ngClass]="(box.tile.noteTiles?.shape=='50')?'grid-rounded':''">
                <div class="tile tile-type-note" [style.background-color]="box.tile.noteTiles.bodyBgColor" (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                     (mousedown)="editRecord(box.tile, box.tile.tileTypeId,i)" (mouseup)="clickAndHold(box.tile, box.tile.tileTypeId,i)" (mouseleave)="clickAndHold(box.tile, box.tile.tileTypeId,i)">
                  <h5 *ngIf="box.tile.noteTiles?.title && !box.tile.noteTiles?.isManual" class="tile-title wraptext" popover="{{box.tile.noteTiles?.title}}" triggers="hover" container="body"
                      [ngStyle]="{'color': box.tile.noteTiles.titleTextColor, 'background-color': box.tile.noteTiles.titleBgColor}"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?13:15">
                    {{box.tile.noteTiles?.title}}
                  </h5>
                  <h5 *ngIf="box.tile.noteTiles?.title && box.tile.noteTiles?.isManual" class="tile-title wraptext" popover="{{box.tile.noteTiles?.title}}" triggers="hover" container="body"
                      [ngStyle]="{'color': box.tile.noteTiles.titleTextColor, 'background-color': box.tile.noteTiles.titleBgColor}"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.tile.noteTiles?.fontSizeTitle">
                    {{box.tile.noteTiles?.title}}
                  </h5>

                  <div class="tile-body">
                    <div class="" [ngClass]="(box.tile.noteTiles?.shape=='50')?'grid-rounded':''">
                      <p class="text-left" [style.background-color]="white"
                         [froalaView]="GetDescription(box.tile.noteTiles?.content)">
                      </p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="tile-group tile-group-item_counts" *ngIf="box.tile.tileTypeId==TILES.IMAGE && box.tile.imageTiles" [ngClass]="(box.tile.imageTiles?.shape=='50')?'grid-rounded':(box.tile.imageTiles?.shape=='100')?'grid-circle':''">
                <div class="tile tile-type-note" [style.background-color]="box.tile.imageTiles?.bodyBgColor" (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                     (mousedown)="editRecord(box.tile, box.tile.tileTypeId,i)" (mouseup)="clickAndHold(box.tile, box.tile.tileTypeId,i)" (mouseleave)="clickAndHold(box.tile, box.tile.tileTypeId,i)">
                  <h5 *ngIf="box.tile.imageTiles?.title && !box.tile.imageTiles?.isManual" class="tile-title wraptext" [ngStyle]="{'color': box.tile.imageTiles.titleTextColor, 'background-color': box.tile.imageTiles.titleBgColor}"
                      popover="{{box.tile.imageTiles?.title}}" triggers="hover" container="body"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?13:15">
                    {{box.tile.imageTiles?.title}}
                  </h5>
                  <h5 *ngIf="box.tile.imageTiles?.title && box.tile.imageTiles?.isManual" class="tile-title wraptext" [ngStyle]="{'color': box.tile.imageTiles.titleTextColor, 'background-color': box.tile.imageTiles.titleBgColor}"
                      popover="{{box.tile.imageTiles?.title}}" triggers="hover" container="body"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.tile.imageTiles?.fontSizeTitle">
                    {{box.tile.imageTiles?.title}}
                  </h5>

                  <div class="tile-body">
                    <img onerror="this.src = 'https://rpgsmithsa.blob.core.windows.net/stock-defimg-rulesets/RS.png';" [src]="box.tile.imageTiles?.imageUrl" [alt]="box.tile.imageTiles?.title" class="imgwidth">
                  </div>
                </div>
              </div>

              <div class="tile-group tile-group-item_counts" *ngIf="box.tile.tileTypeId==TILES.COUNTER && box.tile.counterTiles" [ngClass]="(box.tile.counterTiles?.shape=='50')?'grid-rounded':(box.tile.counterTiles?.shape=='100')?'grid-circle':''">
                <div class="tile tile-type-note tile-color-6" [style.background-color]="box.tile.counterTiles?.bodyBgColor" (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                     (mousedown)="editRecord(box.tile, box.tile.tileTypeId,i)" (mouseup)="clickAndHold(box.tile, box.tile.tileTypeId,i)" (mouseleave)="clickAndHold(box.tile, box.tile.tileTypeId,i)">
                  <h5 *ngIf="box.tile.counterTiles?.title && !box.tile.counterTiles?.isManual" class="tile-title wraptext" [ngStyle]="{'color': box.tile.counterTiles.titleTextColor, 'background-color': box.tile.counterTiles.titleBgColor}"
                      popover="{{box.tile.counterTiles?.title}}" triggers="hover" container="body"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?13:15">
                    {{box.tile.counterTiles?.title}}
                  </h5>
                  <h5 *ngIf="box.tile.counterTiles?.title && box.tile.counterTiles?.isManual" class="tile-title wraptext" [ngStyle]="{'color': box.tile.counterTiles.titleTextColor, 'background-color': box.tile.counterTiles.titleBgColor}"
                      popover="{{box.tile.counterTiles?.title}}" triggers="hover" container="body"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.tile.counterTiles?.fontSizeTitle">
                    {{box.tile.counterTiles?.title}}
                  </h5>

                  <div class="tile-body" *ngIf="!box.tile.counterTiles?.isManual">
                    <span [style.font-size.px]="box.config.sizex*box.config.sizey*5+30" class="textfont" [style.color]="box.tile.counterTiles.bodyTextColor" [style.background-color]="box.tile.counterTiles.bodyBgColor">
                      {{box.tile.counterTiles?.currentValue}}
                    </span>
                  </div>
                  <div class="tile-body" *ngIf="box.tile.counterTiles?.isManual">
                    <span [style.font-size.px]="box.tile.counterTiles?.fontSize" class="textfont" [style.color]="box.tile.counterTiles.bodyTextColor" [style.background-color]="box.tile.counterTiles.bodyBgColor">
                      {{box.tile.counterTiles?.currentValue}}
                    </span>
                  </div>

                </div>
              </div>

              <div class="tile-group tile-group-item_counts" *ngIf="box.tile.tileTypeId==TILES.CHARACTERSTAT && box.tile.characterStatTiles" [ngClass]="(box.tile.characterStatTiles?.shape=='50')?'grid-rounded':(box.tile.characterStatTiles?.shape=='100')?'grid-circle':''">
                <div class="tile tile-type-note  tile-color-6" (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                     [style.background-color]="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command?((box.tile.characterStatTiles?.showTitle && !box.tile?.characterStatTiles?.imageUrl)?box.tile.characterStatTiles.titleBgColor:box.tile.characterStatTiles.bodyBgColor):box.tile.characterStatTiles.bodyBgColor"
                     (mousedown)="editRecord(box.tile, box.tile.tileTypeId,i)" (mouseup)="clickAndHold(box.tile, box.tile.tileTypeId,i)" (mouseleave)="clickAndHold(box.tile, box.tile.tileTypeId,i)">
                  <ng-container *ngIf="!box.tile.characterStatTiles?.isManual">
                    <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.characterStatTiles?.titleTextColor, 'background-color': box.tile.characterStatTiles.titleBgColor}"
                        *ngIf="(box.tile.characterStatTiles?.showTitle && box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId!==STAT_TYPE.Command)||(box.tile.characterStatTiles?.showTitle && box.tile?.characterStatTiles?.imageUrl && box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command)"
                        popover="{{box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.statName}}" triggers="hover" container="body"
                        [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?13:15">
                      {{box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.statName}}
                    </h5>
                  </ng-container>
                  <ng-container *ngIf="box.tile.characterStatTiles?.isManual">
                    <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.characterStatTiles?.titleTextColor, 'background-color': box.tile.characterStatTiles.titleBgColor}"
                        *ngIf="(box.tile.characterStatTiles?.showTitle && box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId!==STAT_TYPE.Command)||(box.tile.characterStatTiles?.showTitle && box.tile?.characterStatTiles?.imageUrl && box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command)"
                        popover="{{box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.statName}}" triggers="hover" container="body"
                        [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.tile.characterStatTiles?.fontSizeTitle">
                      {{box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.statName}}
                    </h5>
                  </ng-container>
                  <div class="tile-body text-overflow-hidden">
                    <div [ngClass]="(box.tile.characterStatTiles?.shape=='50')?'grid-rounded':''" [style.color]="box.tile.characterStatTiles.bodyTextColor"
                         [style.background-color]="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.RichText ? '' : (box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command && box.tile.characterStatTiles?.showTitle && !box.tile?.characterStatTiles?.imageUrl)?box.tile.characterStatTiles.titleBgColor:box.tile.characterStatTiles.bodyBgColor"
                         *ngIf="!box.tile.characterStatTiles?.isManual">

                      <span class="text-center-v" [style.color]="box.tile.characterStatTiles.bodyTextColor"
                            [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)"
                            [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)"
                            *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Text">
                        {{GetDescription(box.tile.characterStatTiles?.charactersCharacterStat?.text)}}

                      </span>

                      <span style="color:#000" *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.RichText"
                            [froalaView]="GetDescription(box.tile.characterStatTiles?.charactersCharacterStat?.richText)">
                      </span>

                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Number" [style.font-size.px]="box.config.sizex*box.config.sizey*5+30" class="text-center-v">
                        {{box.tile.characterStatTiles?.charactersCharacterStat?.number}}
                      </span>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.CurrentMax" [style.font-size.px]="box.config.sizex*box.config.sizey*2+11" class="text-center-v">
                        {{box.tile.characterStatTiles?.charactersCharacterStat.current}} / {{box.tile.characterStatTiles?.charactersCharacterStat.maximum}}
                      </span>

                      <div class="text-center-v bold-whitebg-textblack" *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Choice">
                        <p style="padding:0" *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect || (box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect && box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isChoiceNumeric)">
                          <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect && box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isChoiceNumeric">

                            <span class="no-comma"
                                  [style.font-size.px]="((box.config.sizey+box.config.sizex)*2) < 16 ? 18 : ((box.config.sizey+box.config.sizex)*2)"
                                  [style.line-height.px]="((box.config.sizey+box.config.sizex)*2+5)  < 18 ? 20 : ((box.config.sizey+box.config.sizex)*2+5)">
                              {{box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue}} {{box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect ? box.tile.characterStatTiles?.charactersCharacterStat?.multiChoice?.length ? '/':'' :box.tile.characterStatTiles?.charactersCharacterStat?.choice?.length ? '/':''}}

                            </span>

                          </ng-container>

                          <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect">
                            <ng-container *ngFor="let choice of box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatChoices; let i = index">
                              <ng-container *ngFor="let mChoice of box.tile.characterStatTiles?.charactersCharacterStat?.multiChoice?.split(';');let j = index">

                                <span *ngIf="choice?.characterStatChoiceId===+mChoice && box.tile.characterStatTiles?.charactersCharacterStat?.multiChoice?.split(';')?.length>1"
                                      [style.font-size.px]="((box.config.sizey+box.config.sizex)*2) < 16 ? 18 : ((box.config.sizey+box.config.sizex)*2)"
                                      [style.line-height.px]="((box.config.sizey+box.config.sizex)*2+5)  < 18 ? 20 : ((box.config.sizey+box.config.sizex)*2+5)">
                                  {{choice.statChoiceValue}}

                                </span>
                                <span *ngIf="choice?.characterStatChoiceId===+mChoice && box.tile.characterStatTiles?.charactersCharacterStat?.multiChoice?.split(';')?.length<=1"
                                      [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)"
                                      [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                  {{choice.statChoiceValue}}

                                </span>

                              </ng-container>
                            </ng-container>
                          </ng-container>
                        </p>
                        <ng-container *ngIf="!box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect">
                          <p>
                            <ng-container *ngFor="let choice of box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatChoices; let i = index">
                              <span class="no-comma" *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isChoiceNumeric && i==0" [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)"
                                    [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                {{box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue}} {{box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect ? box.tile.characterStatTiles?.charactersCharacterStat?.multiChoice?.length ? '/':'' :box.tile.characterStatTiles?.charactersCharacterStat?.choice?.length ? '/':''}}

                              </span>
                            </ng-container>
                            <ng-container *ngFor="let choice of box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatChoices; let i = index">
                              <span *ngIf="choice?.characterStatChoiceId===+box.tile.characterStatTiles?.charactersCharacterStat?.choice" [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)"
                                    [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                {{choice.statChoiceValue}}
                              </span>
                            </ng-container>
                          </p>
                        </ng-container>
                        <!--<span *ngIf="choice?.characterStatChoiceId===+box.tile.characterStatTiles?.charactersCharacterStat?.choice" [style.font-size.px]="box.config.sizex*box.config.sizey*5+16" class="text-center-v">
                            {{choice.statChoiceValue}}
                        </span>-->

                      </div>

                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.ValueSubValue" [style.font-size.px]="box.config.sizex*box.config.sizey*2+11" class="text-center-v">

                        {{box.tile.characterStatTiles?.charactersCharacterStat.value}} ({{box.tile.characterStatTiles?.charactersCharacterStat.subValue}})
                      </span>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.OnOff" [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v">
                        {{box.tile.characterStatTiles?.charactersCharacterStat?.onOff ? 'ON' : 'OFF'}}
                      </span>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.YesNo" [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v">
                        {{box.tile.characterStatTiles?.charactersCharacterStat?.yesNo ? 'YES' : 'NO'}}
                      </span>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Calculation" [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v">
                        {{box.tile.characterStatTiles?.charactersCharacterStat?.calculationResult}}
                      </span>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command">

                        <img *ngIf="(box.tile.characterStatTiles?.showTitle && box.tile?.characterStatTiles?.imageUrl) || !box.tile.characterStatTiles?.showTitle"
                             [src]="box.tile?.characterStatTiles?.imageUrl" [alt]="box.tile?.characterStatTiles?.imageUrl"
                             class="imgwidth" onerror="this.src='https://rpgsmithsa.blob.core.windows.net/stock-icons/d20.png';">

                        <span *ngIf="box.tile.characterStatTiles?.showTitle && !box.tile?.characterStatTiles?.imageUrl" class="text-center-v"
                              [ngStyle]="{'color': box.tile.characterStatTiles?.titleTextColor, 'background-color': box.tile.characterStatTiles?.titleBgColor}"
                              popover="{{box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.statName}}" triggers="hover" container="body"
                              [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey"
                              [style.line-height.px]="box.config.sizey==1?13:30+box.config.sizex+box.config.sizey"
                              [style.font-size.px]="box.config.sizey==1?13:15+box.config.sizex+box.config.sizey">
                          {{box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.statName}}
                        </span>

                      </span>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Combo" class="text-center-v" [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                        {{box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue}}
                        <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.comboText"> / {{box.tile.characterStatTiles?.charactersCharacterStat?.comboText}}</span>
                      </span>

                      <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Toggle">
                        <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.yesNo">
                          <span [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v noselect">{{box.tile.characterStatTiles?.charactersCharacterStat?.isYes ? 'YES' : 'NO'}}</span>
                        </ng-container>
                        <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.onOff">
                          <span [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v noselect">{{box.tile.characterStatTiles?.charactersCharacterStat?.isOn ? 'ON' : 'OFF'}}</span>
                        </ng-container>
                        <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.display">
                          <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.showCheckbox" [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v icon-Gen-Check noselect"></span>
                          <span *ngIf="!box.tile.characterStatTiles?.charactersCharacterStat?.showCheckbox" [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v icon-Gen-Uncheck noselect"></span>
                        </ng-container>


                        <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.isCustom">
                          <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterCustomToggles?.length">
                            <ng-container *ngFor="let toggleVal of box.tile.characterStatTiles?.charactersCharacterStat?.characterCustomToggles; let i = index">
                              <ng-container *ngIf="toggleVal.initial">
                                <ng-container *ngIf="toggleVal.toggleText">

                                  <!--<p class="noselect" [style.color]="box.tile.characterStatTiles.bodyTextColor"
                                     [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                    {{toggleVal.toggleText}}
                                  </p>-->

                                  <span class="noselect text-center-v" [style.color]="box.tile.characterStatTiles.bodyTextColor"
                                        [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                    {{toggleVal.toggleText}}
                                  </span>

                                </ng-container>
                                <ng-container *ngIf="toggleVal.image">
                                  <img class="imgwidth" [src]="toggleVal.image" onerror="this.src = 'https://rpgsmithsa.blob.core.windows.net/stock-defimg-rulesets/RS.png';" />
                                </ng-container>
                              </ng-container>

                            </ng-container>
                          </ng-container>
                        </ng-container>

                      </ng-container>

                      <div *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.LinkRecord">
                        <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue">
                          <img *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue && box.tile.characterStatTiles?.displayLinkImage" class="imgwidth" [src]="GetLinkRecordImage(box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue,box.tile.characterStatTiles?.charactersCharacterStat?.linkType)" onerror="this.src = 'https://rpgsmithsa.blob.core.windows.net/stock-defimg-rulesets/RS.png';" />

                          <p [style.color]="box.tile.characterStatTiles.bodyTextColor"
                             [style.font-size.px]="box.config.sizex > box.config.sizey ? (box.config.sizey*4 <= 14 ? 16 : box.config.sizey*4 ) :  (box.config.sizex*4 <= 14 ? 16 : box.config.sizex*4 ) "
                             [style.line-height.px]="box.config.sizex > box.config.sizey ? (box.config.sizey*5 <= 18 ? 20 : box.config.sizey*5 ) :  (box.config.sizex*5 <= 18 ? 20 : box.config.sizex*5 ) "
                             *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue && !box.tile.characterStatTiles?.displayLinkImage">
                            {{GetLinkRecordText(box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue,box.tile.characterStatTiles?.charactersCharacterStat?.linkType)}}
                          </p>
                        </ng-container>

                        <ng-container *ngIf="!box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue">
                          <p [style.color]="box.tile.characterStatTiles.bodyTextColor"
                             [style.font-size.px]="box.config.sizex > box.config.sizey ? (box.config.sizey*4 <= 14 ? 16 : box.config.sizey*4 ) :  (box.config.sizex*4 <= 14 ? 16 : box.config.sizex*4 ) ">
                            The targeted record has been removed
                          </p>
                        </ng-container>

                      </div>
                      <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Condition">
                        <span class="text-center-v" [style.color]="box.tile.characterStatTiles.bodyTextColor"
                              [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)"
                              [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                          {{box.tile.characterStatTiles?.charactersCharacterStat?.text}}
                        </span>
                      </ng-container>
                    </div>
                    <!--font Control-->
                    <div [ngClass]="(box.tile.characterStatTiles?.shape=='50')?'grid-rounded':''" [style.color]="box.tile.characterStatTiles.bodyTextColor"
                         [style.background-color]="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.RichText ? '' : (box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command && box.tile.characterStatTiles?.showTitle && !box.tile?.characterStatTiles?.imageUrl)?box.tile.characterStatTiles.titleBgColor:box.tile.characterStatTiles.bodyBgColor"
                         *ngIf="box.tile.characterStatTiles?.isManual">
                      <span class="text-center-v" [style.color]="box.tile.characterStatTiles.bodyTextColor"
                            [style.font-size.px]="box.tile.characterStatTiles?.fontSize"
                            [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)"
                            *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Text">
                        {{GetDescription(box.tile.characterStatTiles?.charactersCharacterStat?.text)}}
                      </span>

                      <span style="color:#000" *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.RichText"
                            [froalaView]="GetDescription(box.tile.characterStatTiles?.charactersCharacterStat?.richText)">
                      </span>

                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Number" [style.font-size.px]="box.tile.characterStatTiles?.fontSize" class="text-center-v">
                        {{box.tile.characterStatTiles?.charactersCharacterStat?.number}}
                      </span>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.CurrentMax" [style.font-size.px]="box.tile.characterStatTiles?.fontSize" class="text-center-v">
                        {{box.tile.characterStatTiles?.charactersCharacterStat.current}} / {{box.tile.characterStatTiles?.charactersCharacterStat.maximum}}
                      </span>

                      <div class="text-center-v bold-whitebg-textblack" *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Choice">
                        <p style="padding:0" *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect || (box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect && box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isChoiceNumeric)">
                          <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect && box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isChoiceNumeric">

                            <span class="no-comma"
                                  [style.font-size.px]="box.tile.characterStatTiles?.fontSize"
                                  [style.line-height.px]="((box.config.sizey+box.config.sizex)*2+5)  < 18 ? 20 : ((box.config.sizey+box.config.sizex)*2+5)">
                              {{box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue}} {{box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect ? box.tile.characterStatTiles?.charactersCharacterStat?.multiChoice?.length ? '/':'' :box.tile.characterStatTiles?.charactersCharacterStat?.choice?.length ? '/':''}}
                            </span>
                          </ng-container>

                          <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect">
                            <ng-container *ngFor="let choice of box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatChoices; let i = index">
                              <ng-container *ngFor="let mChoice of box.tile.characterStatTiles?.charactersCharacterStat?.multiChoice?.split(';');let j = index">

                                <span *ngIf="choice?.characterStatChoiceId===+mChoice && box.tile.characterStatTiles?.charactersCharacterStat?.multiChoice?.split(';')?.length>1"
                                      [style.font-size.px]="box.tile.characterStatTiles?.fontSize"
                                      [style.line-height.px]="((box.config.sizey+box.config.sizex)*2+5)  < 18 ? 20 : ((box.config.sizey+box.config.sizex)*2+5)">
                                  {{choice.statChoiceValue}}
                                </span>
                                <span *ngIf="choice?.characterStatChoiceId===+mChoice && box.tile.characterStatTiles?.charactersCharacterStat?.multiChoice?.split(';')?.length<=1"
                                      [style.font-size.px]="box.tile.characterStatTiles?.fontSize"
                                      [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                  {{choice.statChoiceValue}}
                                </span>

                              </ng-container>
                            </ng-container>
                          </ng-container>
                        </p>
                        <ng-container *ngIf="!box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect">
                          <p>
                            <ng-container *ngFor="let choice of box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatChoices; let i = index">
                              <span class="no-comma" *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isChoiceNumeric && i==0" [style.font-size.px]="box.tile.characterStatTiles?.fontSize"
                                    [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                {{box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue}} {{box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.isMultiSelect ? box.tile.characterStatTiles?.charactersCharacterStat?.multiChoice?.length ? '/':'' :box.tile.characterStatTiles?.charactersCharacterStat?.choice?.length ? '/':''}}

                              </span>
                            </ng-container>
                            <ng-container *ngFor="let choice of box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatChoices; let i = index">
                              <span *ngIf="choice?.characterStatChoiceId===+box.tile.characterStatTiles?.charactersCharacterStat?.choice" [style.font-size.px]="box.tile.characterStatTiles?.fontSize"
                                    [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                {{choice.statChoiceValue}}
                              </span>
                            </ng-container>
                          </p>
                        </ng-container>
                      </div>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.ValueSubValue" [style.font-size.px]="box.tile.characterStatTiles?.fontSize" class="text-center-v">

                        {{box.tile.characterStatTiles?.charactersCharacterStat.value}} ({{box.tile.characterStatTiles?.charactersCharacterStat.subValue}})
                      </span>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.OnOff" [style.font-size.px]="box.tile.characterStatTiles?.fontSize" class="text-center-v">
                        {{box.tile.characterStatTiles?.charactersCharacterStat?.onOff ? 'ON' : 'OFF'}}
                      </span>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.YesNo" [style.font-size.px]="box.tile.characterStatTiles?.fontSize" class="text-center-v">
                        {{box.tile.characterStatTiles?.charactersCharacterStat?.yesNo ? 'YES' : 'NO'}}
                      </span>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Calculation" [style.font-size.px]="box.tile.characterStatTiles?.fontSize" class="text-center-v">
                        {{box.tile.characterStatTiles?.charactersCharacterStat?.calculationResult}}
                      </span>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command">

                        <img *ngIf="(box.tile.characterStatTiles?.showTitle && box.tile?.characterStatTiles?.imageUrl) || !box.tile.characterStatTiles?.showTitle"
                             [src]="box.tile?.characterStatTiles?.imageUrl" [alt]="box.tile?.characterStatTiles?.imageUrl"
                             class="imgwidth" onerror="this.src='https://rpgsmithsa.blob.core.windows.net/stock-icons/d20.png';">

                        <span *ngIf="box.tile.characterStatTiles?.showTitle && !box.tile?.characterStatTiles?.imageUrl" class="text-center-v"
                              [ngStyle]="{'color': box.tile.characterStatTiles?.titleTextColor, 'background-color': box.tile.characterStatTiles?.titleBgColor}"
                              popover="{{box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.statName}}" triggers="hover" container="body"
                              [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey"
                              [style.line-height.px]="box.config.sizey==1?13:30+box.config.sizex+box.config.sizey"
                              [style.font-size.px]="box.tile.characterStatTiles?.fontSize">
                          {{box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.statName}}
                        </span>

                      </span>
                      <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Combo" class="text-center-v" [style.font-size.px]="box.tile.characterStatTiles?.fontSize" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                        {{box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue}}
                        <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.comboText"> / {{box.tile.characterStatTiles?.charactersCharacterStat?.comboText}}</span>
                      </span>

                      <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Toggle">
                        <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.yesNo">
                          <span [style.font-size.px]="box.tile.characterStatTiles?.fontSize" class="text-center-v noselect">{{box.tile.characterStatTiles?.charactersCharacterStat?.isYes ? 'YES' : 'NO'}}</span>
                        </ng-container>
                        <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.onOff">
                          <span [style.font-size.px]="box.tile.characterStatTiles?.fontSize" class="text-center-v noselect">{{box.tile.characterStatTiles?.charactersCharacterStat?.isOn ? 'ON' : 'OFF'}}</span>
                        </ng-container>
                        <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.display">
                          <span *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.showCheckbox" [style.font-size.px]="box.tile.characterStatTiles?.fontSize" class="text-center-v icon-Gen-Check noselect"></span>
                          <span *ngIf="!box.tile.characterStatTiles?.charactersCharacterStat?.showCheckbox" [style.font-size.px]="box.tile.characterStatTiles?.fontSize" class="text-center-v icon-Gen-Uncheck noselect"></span>
                        </ng-container>


                        <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.isCustom">
                          <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterCustomToggles?.length">
                            <ng-container *ngFor="let toggleVal of box.tile.characterStatTiles?.charactersCharacterStat?.characterCustomToggles; let i = index">
                              <ng-container *ngIf="toggleVal.initial">
                                <ng-container *ngIf="toggleVal.toggleText">

                                  <span class="noselect text-center-v" [style.color]="box.tile.characterStatTiles.bodyTextColor"
                                        [style.font-size.px]="box.tile.characterStatTiles?.fontSize" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                    {{toggleVal.toggleText}}
                                  </span>

                                </ng-container>
                                <ng-container *ngIf="toggleVal.image">
                                  <img class="imgwidth" [src]="toggleVal.image" onerror="this.src = 'https://rpgsmithsa.blob.core.windows.net/stock-defimg-rulesets/RS.png';" />
                                </ng-container>
                              </ng-container>

                            </ng-container>
                          </ng-container>
                        </ng-container>

                      </ng-container>

                      <div *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.LinkRecord">
                        <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue">
                          <img *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue && box.tile.characterStatTiles?.displayLinkImage" class="imgwidth" [src]="GetLinkRecordImage(box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue,box.tile.characterStatTiles?.charactersCharacterStat?.linkType)" onerror="this.src = 'https://rpgsmithsa.blob.core.windows.net/stock-defimg-rulesets/RS.png';" />

                          <p [style.color]="box.tile.characterStatTiles.bodyTextColor"
                             [style.font-size.px]="box.tile.characterStatTiles?.fontSize"
                             [style.line-height.px]="box.config.sizex > box.config.sizey ? (box.config.sizey*5 <= 18 ? 20 : box.config.sizey*5 ) :  (box.config.sizex*5 <= 18 ? 20 : box.config.sizex*5 ) "
                             *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue && !box.tile.characterStatTiles?.displayLinkImage">
                            {{GetLinkRecordText(box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue,box.tile.characterStatTiles?.charactersCharacterStat?.linkType)}}
                          </p>
                        </ng-container>

                        <ng-container *ngIf="!box.tile.characterStatTiles?.charactersCharacterStat?.defaultValue">
                          <p [style.color]="box.tile.characterStatTiles.bodyTextColor"
                             [style.font-size.px]="box.tile.characterStatTiles?.fontSize">
                            The targeted record has been removed
                          </p>
                        </ng-container>

                      </div>
                      <ng-container *ngIf="box.tile.characterStatTiles?.charactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Condition">
                        <span class="text-center-v" [style.color]="box.tile.characterStatTiles.bodyTextColor"
                              [style.font-size.px]="box.tile.characterStatTiles?.fontSize"
                              [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                          {{box.tile.characterStatTiles?.charactersCharacterStat?.text}}
                        </span>
                      </ng-container>
                    </div>
                    <!--font Control-->
                  </div>

                </div>
              </div>
              <!--linktiles-->
              <div class="tile-group tile-group-item_counts tooltip1" *ngIf="box.tile.tileTypeId==TILES.LINK && box.tile.linkTiles" [ngClass]="(box.tile.linkTiles?.shape=='50')?'grid-rounded':(box.tile.linkTiles?.shape=='100')?'grid-circle':''">
                <div class="tile tile-type-note tile-color-6"
                     [style.background-color]=" (box.tile.linkTiles?.showTitle && !box.tile.linkTiles?.displayLinkImage)? box.tile.linkTiles.titleBgColor :box.tile.linkTiles?.bodyBgColor" [ngClass]="(box.tile.linkTiles?.shape=='50')?'grid-rounded':(box.tile.linkTiles?.shape=='100')?'grid-circle':''"
                     (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                     (mousedown)="editRecord(box.tile, box.tile.tileTypeId,i)" (mouseup)="clickAndHold(box.tile, box.tile.tileTypeId,i)" (mouseleave)="clickAndHold(box.tile, box.tile.tileTypeId,i)">
                  <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.linkTiles.titleTextColor, 'background-color': box.tile.linkTiles.titleBgColor}"
                      *ngIf="box.tile.linkTiles?.showTitle && box.tile.linkTiles?.displayLinkImage && !box.tile.linkTiles?.isManual"
                      popover="{{box.tile.linkTiles?.linkType=='Spell' ? box.tile.linkTiles?.spell?.spell?.name : box.tile.linkTiles?.linkType=='Ability' ? box.tile.linkTiles?.ability?.ability?.name : box.tile.linkTiles?.linkType=='Item' ? box.tile.linkTiles?.item?.name : box.tile.linkTiles?.linkType=='BuffAndEffect' ? box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.linkTiles?.linkType=='Allies' ? box.tile.linkTiles?.ally?.name : ''}}" triggers="hover" container="body"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?13:15">
                    {{box.tile.linkTiles?.linkType=='Spell' ? box.tile.linkTiles?.spell?.spell?.name : box.tile.linkTiles?.linkType=='Ability' ? box.tile.linkTiles?.ability?.ability?.name : box.tile.linkTiles?.linkType=='Item' ? box.tile.linkTiles?.item?.name :box.tile.linkTiles?.linkType=='BuffAndEffect' ? box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.linkTiles?.linkType=='Allies' ? box.tile.linkTiles?.ally?.name : ''}}
                  </h5>
                  <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.linkTiles.titleTextColor, 'background-color': box.tile.linkTiles.titleBgColor}"
                      *ngIf="box.tile.linkTiles?.showTitle && box.tile.linkTiles?.displayLinkImage && box.tile.linkTiles?.isManual"
                      popover="{{box.tile.linkTiles?.linkType=='Spell' ? box.tile.linkTiles?.spell?.spell?.name : box.tile.linkTiles?.linkType=='Ability' ? box.tile.linkTiles?.ability?.ability?.name : box.tile.linkTiles?.linkType=='Item' ? box.tile.linkTiles?.item?.name : box.tile.linkTiles?.linkType=='BuffAndEffect' ? box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.linkTiles?.linkType=='Allies' ? box.tile.linkTiles?.ally?.name : ''}}" triggers="hover" container="body"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.tile.linkTiles?.fontSizeTitle">
                    {{box.tile.linkTiles?.linkType=='Spell' ? box.tile.linkTiles?.spell?.spell?.name : box.tile.linkTiles?.linkType=='Ability' ? box.tile.linkTiles?.ability?.ability?.name : box.tile.linkTiles?.linkType=='Item' ? box.tile.linkTiles?.item?.name :box.tile.linkTiles?.linkType=='BuffAndEffect' ? box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.linkTiles?.linkType=='Allies' ? box.tile.linkTiles?.ally?.name : ''}}
                  </h5>

                  <!--Items Tile Detail-->
                  <div class="top1" *ngIf="box.tile.linkTiles?.linkType=='Item' && box.tile.linkTiles?.item?.name">
                    <div class="item-info mb-0">
                      <div class="container px-0">
                        <div class="item-info-wrapper">
                          <div class="item-info-top-section">
                            <div class="row">
                              <div class="col">
                                <div class="item-info-banner">
                                  <div class="item-info-image">
                                    <img class="card-img-top" [src]="box.tile.linkTiles?.item?.itemImage" [alt]="box.tile.linkTiles?.item?.name"
                                         onerror="this.src='../assets/images/DefaultImages/Item.jpg';" />
                                  </div>
                                  <h2 class="item-info-name mb-0">
                                    {{box.tile.linkTiles?.item?.name}}
                                  </h2>
                                  <div class="item-info-props-indics">
                                    <ul class="item-info-props">
                                      <li *ngIf="box.tile.linkTiles?.item?.rarity">{{box.tile.linkTiles?.item?.rarity}}</li>
                                      <li *ngIf="box.tile.linkTiles?.item?.value">{{box.tile.linkTiles?.item?.value}} {{box.tile.linkTiles?.item?.currencyLabel}}</li>
                                      <li *ngIf="box.tile.linkTiles?.item?.weight">{{box.tile.linkTiles?.item?.weight}} {{box.tile.linkTiles?.item?.weightLabel}}</li>
                                      <li *ngIf="box.tile.linkTiles?.item?.volume">{{box.tile.linkTiles?.item?.volume}} {{box.tile.linkTiles?.item?.volumeLabel}}</li>
                                    </ul>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-3 align-self-start">
                              <ul class="item-info-indics ml-3 w-100 mt-5 justify-content-start list-unstyled">
                                <li *ngIf="box.tile.linkTiles?.item?.isConsumable" title="Consumable" data-toggle="tooltip">
                                  <i class="item-property item-property-icon icon icon-Rec-consumable icon-ico"></i>
                                </li>
                                <li *ngIf="box.tile.linkTiles?.item?.isMagical" title="Magical" data-toggle="tooltip">
                                  <i class="item-property item-property-icon icon icon-Rec-Magical icon-ico"></i>
                                </li>
                                <li *ngIf="box.tile.linkTiles?.item?.isContainer" title="Container" data-toggle="tooltip">
                                  <i class="item-property item-property-icon icon icon-Rec-Container icon-ico"></i>
                                </li>
                              </ul>
                            </div>
                            <div class="col-9">
                              <div class="item-info-actions ml-0 h-100 w-100">
                                <div class="item-info-bottom-section px-2 pt-3">
                                  <div class="row">
                                    <div class="col-md-12">
                                      <div class="item-info-desc d-block mr-0">
                                        <h3>Description</h3>
                                        <p [froalaView]="box.tile.linkTiles?.item?.description"></p>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats ml-0">
                                        <h3>Stats</h3>
                                        <p [froalaView]="box.tile.linkTiles?.item?.itemStats"></p>
                                      </div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats mr-0">
                                        <h3>GM Only</h3>
                                        <p [froalaView]="box.tile.linkTiles?.item?.gmOnly"></p>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--Items Tile Detail-->
                  <!--Spell Tile Detail-->
                  <div class="top1" *ngIf="box.tile.linkTiles?.linkType=='Spell' && box.tile.linkTiles?.spell?.spell?.name">
                    <div class="item-info mb-0">
                      <div class="container px-0">
                        <div class="item-info-wrapper">
                          <div class="item-info-top-section">
                            <div class="row">
                              <div class="col">
                                <div class="item-info-banner">
                                  <div class="item-info-image">
                                    <img class="card-img-top" [src]="box.tile.linkTiles?.spell?.spell?.imageUrl" [alt]="box.tile.linkTiles?.spell?.spell?.name"
                                         onerror="this.src='../assets/images/DefaultImages/Spell.jpg';" />
                                  </div>
                                  <h2 class="item-info-name mb-0">
                                    {{box.tile.linkTiles?.spell?.spell?.name}}
                                  </h2>
                                  <!-- End of item name -->
                                  <div class="item-info-props-indics">
                                    <!-- Item properties -->
                                    <ul class="item-info-props">
                                      <li *ngIf="box.tile.linkTiles?.spell?.spell?.levels"> {{box.tile.linkTiles?.spell?.spell?.levels}} Level</li>
                                      <li *ngIf="box.tile.linkTiles?.spell?.spell?.castingTime"> {{box.tile.linkTiles?.spell?.spell?.castingTime}}</li>
                                    </ul>

                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-3 align-self-start">
                                    <ul class="item-info-indics ml-3 w-100 mt-5 justify-content-start">
                                      <li *ngIf="box.tile.linkTiles?.spell?.spell?.isSomaticComponent" class="icon"><i class="item-property item-property-icon icon-ico icon-Rec-Somantic"></i></li>
                                      <li *ngIf="box.tile.linkTiles?.spell?.spell?.isVerbalComponent" class="icon"><i class="item-property item-property-icon icon-ico icon-Rec-Verbal"></i></li>
                                      <li *ngIf="box.tile.linkTiles?.spell?.spell?.isMaterialComponent" class="icon"><i class="item-property item-property-icon icon-ico icon-Rec-Material icon-rsi"></i></li>
                                    </ul>
                                  </div>
                                  <div class="col-9">
                                    <div class="item-info-actions ml-0 h-100">
                                      <div class="item-info-bottom-section px-2 pt-3">
                                        <div class="form-row">
                                          <div class="col-md-12">
                                            <div class="item-info-command d-block mr-0">
                                              <h3>Description</h3>
                                              <p [froalaView]="box.tile.linkTiles?.spell?.spell?.description"></p>
                                            </div>
                                          </div>
                                        </div>
                                        <div class="row">
                                          <div class="col-12 col-md-6">
                                            <div class="item-info-stats ml-0">
                                              <h3>Stats</h3>
                                              <p [froalaView]="box.tile.linkTiles?.spell?.spell?.stats"></p>
                                            </div>
                                          </div>
                                          <div class="col-12 col-md-6">
                                            <div class="item-info-command mr-0">
                                              <h3>GM Only</h3>
                                              <p [froalaView]="box.tile.linkTiles?.spell?.spell?.gmOnly"></p>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>

                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--Spell Tile Detail-->
                  <!--Ability Tile Detail-->
                  <div class="top1" *ngIf="box.tile.linkTiles?.linkType=='Ability' && box.tile.linkTiles?.ability?.ability?.name">
                    <div class="item-info mb-0">
                      <div class="container px-0">
                        <div class="item-info-wrapper">
                          <div class="item-info-top-section">
                            <div class="row">
                              <div class="col">
                                <div class="item-info-banner">
                                  <div class="item-info-image">
                                    <img class="card-img-top" [src]="box.tile.linkTiles?.ability?.ability?.imageUrl" [alt]="box.tile.linkTiles?.ability?.ability?.name"
                                         onerror="this.src='../assets/images/DefaultImages/ability.jpg';" />
                                  </div>
                                  <h2 class="item-info-name mb-0">
                                    {{box.tile.linkTiles?.ability?.ability?.name}}
                                  </h2>
                                  <div class="item-info-props-indics">
                                    <ul class="item-info-props">
                                      <li *ngIf="box.tile.linkTiles?.ability?.ability?.level">{{box.tile.linkTiles?.ability?.ability?.level}} Level</li>
                                    </ul>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-3 align-self-start">
                              <ul class="item-info-indics ml-3 w-100 mt-5 justify-content-start list-unstyled">
                                <li *ngIf="box.tile.linkTiles?.ability?.ability?.isEnabled">
                                  <i class="icon icon-ico icon-Rec-Enabled"></i>
                                </li>
                              </ul>
                            </div>
                            <div class="col-9">
                              <div class="item-info-actions ml-0 h-100 w-100">
                                <div class="item-info-bottom-section px-2 pt-3">
                                  <div class="row">
                                    <div class="col-md-12">
                                      <div class="item-info-desc d-block mr-0">
                                        <h3>Description</h3>
                                        <p [froalaView]="box.tile.linkTiles?.ability?.ability?.description"></p>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats ml-0">
                                        <h3>Stats</h3>
                                        <p [froalaView]="box.tile.linkTiles?.ability?.ability?.stats"></p>
                                      </div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats mr-0">
                                        <h3>GM Only</h3>
                                        <p [froalaView]="box.tile.linkTiles?.ability?.ability?.gmOnly"></p>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--Ability Tile Detail-->
                  <!--BuffAndEffects Tile Detail-->
                  <div class="top1" *ngIf="box.tile.linkTiles?.linkType=='BuffAndEffect' && box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name">
                    <div class="item-info mb-0">
                      <div class="container px-0">
                        <div class="item-info-wrapper">
                          <div class="item-info-top-section">
                            <div class="row">
                              <div class="col">
                                <div class="item-info-banner">
                                  <div class="item-info-image">
                                    <img class="card-img-top" [src]="box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.imageUrl" [alt]="box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name"
                                         onerror="this.src='../assets/images/BnE/Def_BnE.jpg';" />
                                  </div>
                                  <h2 class="item-info-name mb-0">
                                    {{box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name}}
                                  </h2>
                                  <div class="item-info-props-indics">
                                    <ul class="item-info-props">
                                      <!--<li *ngIf="box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.level">{{box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.level}} Level</li>-->
                                    </ul>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-3 align-self-start">
                              <ul class="item-info-indics ml-3 w-100 mt-5 justify-content-start list-unstyled">
                                <!--<li *ngIf="box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.isEnabled">
                                  <i class="icon icon-ico icon-Rec-Enabled"></i>
                                </li>-->
                              </ul>
                            </div>
                            <div class="col-9">
                              <div class="item-info-actions ml-0 h-100 w-100">
                                <div class="item-info-bottom-section px-2 pt-3">
                                  <div class="row">
                                    <div class="col-md-12">
                                      <div class="item-info-desc d-block mr-0">
                                        <h3>Description</h3>
                                        <p [froalaView]="box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.description"></p>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats ml-0">
                                        <h3>Stats</h3>
                                        <p [froalaView]="box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.stats"></p>
                                      </div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats mr-0">
                                        <h3>GM Only</h3>
                                        <p [froalaView]="box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.gmOnly"></p>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--BuffAndEffects Tile Detail-->
                  <!--Allies Tile Detail-->
                  <div class="top1" *ngIf="box.tile.linkTiles?.linkType=='Allies' && box.tile.linkTiles?.ally?.name">
                    <div class="item-info mb-0">
                      <div class="container px-0">
                        <div class="item-info-wrapper">
                          <div class="item-info-top-section">
                            <div class="row">
                              <div class="col">
                                <div class="item-info-banner">
                                  <div class="item-info-image">
                                    <img class="card-img-top" [src]="box.tile.linkTiles?.ally?.imageUrl" [alt]="box.tile.linkTiles?.ally?.name"
                                         onerror="this.src='../assets/images/DefaultImages/monster.jpg';" />
                                  </div>
                                  <h2 class="item-info-name mb-0">
                                    {{box.tile.linkTiles?.ally?.name}}
                                  </h2>
                                  <div class="item-info-props-indics">
                                    <ul class="item-info-props">
                                      <li *ngIf="box.tile.linkTiles?.ally?.level">{{box.tile.linkTiles?.ally?.level}} Level</li>
                                      <li *ngIf="box.tile.linkTiles?.ally?.challangeRating">CR:{{box.tile.linkTiles?.ally?.challangeRating}}</li>
                                      <li *ngIf="box.tile.linkTiles?.ally?.armorClass">AC :{{box.tile.linkTiles?.ally?.armorClass}}</li>
                                      <li *ngIf="box.tile.linkTiles?.ally?.healthCurrent">{{box.tile.linkTiles?.ally?.healthCurrent}}/{{box.tile.linkTiles?.ally?.healthMax}}</li>
                                    </ul>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-3 align-self-start">
                              <ul class="item-info-indics ml-3 w-100 mt-5 justify-content-start list-unstyled">
                                <li *ngIf="box.tile.linkTiles?.ally?.isEnabled">
                                  <i class="icon icon-ico icon-Rec-Enabled"></i>
                                </li>
                                <li *ngIf="box.tile.linkTiles?.ally?.addToCombatTracker">
                                  <i class="icon icon-with-text icon-Combat icon-rsi"></i>
                                </li>
                              </ul>
                            </div>
                            <div class="col-9">
                              <div class="item-info-actions ml-0 h-100 w-100">
                                <div class="item-info-bottom-section px-2 pt-3">
                                  <div class="row">
                                    <div class="col-md-12">
                                      <div class="item-info-desc d-block mr-0">
                                        <h3>Description</h3>
                                        <p [froalaView]="box.tile.linkTiles?.ally?.description"></p>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats ml-0">
                                        <h3>Stats</h3>
                                        <p [froalaView]="box.tile.linkTiles?.ally?.stats"></p>
                                      </div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats mr-0">
                                        <h3>GM Only</h3>
                                        <p [froalaView]="box.tile.linkTiles?.ally?.gmOnly"></p>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--Allies Tile Detail-->
                  <!--<div class="tile-body"
                  [title]="((box.tile.linkTiles?.showTitle && box.tile.linkTiles?.displayLinkImage)
                  || (!box.tile.linkTiles?.showTitle && box.tile.linkTiles?.displayLinkImage)) ?
                  box.tile.linkTiles?.linkType=='Spell' ? description(box.tile.linkTiles?.spell?.spell?.description) : box.tile.linkTiles?.linkType=='Ability' ? description(box.tile.linkTiles?.ability?.ability?.description) : box.tile.linkTiles?.linkType=='BuffAndEffect' ? description(box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.description) : box.tile.linkTiles?.linkType=='Allies' ? description(box.tile.linkTiles?.ally?.description) : box.tile.linkTiles?.linkType=='Item' ? description(box.tile.linkTiles?.item?.description) : 'Hello2'
                  : 'Hello'">-->

                  <div class="tile-body">

                    <ng-container *ngIf="((box.tile.linkTiles?.linkType=='Spell' && box.tile.linkTiles?.spell?.spell?.name) ||
                                  (box.tile.linkTiles?.linkType=='Ability' && box.tile.linkTiles?.ability?.ability?.name) ||
                                  (box.tile.linkTiles?.linkType=='BuffAndEffect' && box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name) ||
                                  (box.tile.linkTiles?.linkType=='Item' && box.tile.linkTiles?.item?.name) ||
                                  (box.tile.linkTiles?.linkType=='Allies' && box.tile.linkTiles?.ally?.name))">

                      <img *ngIf="(box.tile.linkTiles?.showTitle && box.tile.linkTiles?.displayLinkImage) || (!box.tile.linkTiles?.showTitle && box.tile.linkTiles?.displayLinkImage)"
                           [src]="box.tile.linkTiles?.linkType=='Spell' ? box.tile.linkTiles?.spell?.spell?.imageUrl : box.tile.linkTiles?.linkType=='Ability' ? box.tile.linkTiles?.ability?.ability?.imageUrl : box.tile.linkTiles?.linkType=='BuffAndEffect' ? box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.imageUrl : box.tile.linkTiles?.linkType=='Allies' ? box.tile.linkTiles?.ally?.imageUrl : box.tile.linkTiles?.linkType=='Item' ? box.tile.linkTiles?.item?.itemImage : box.tile.linkTiles?.item?.itemImage"
                           [alt]="box.tile.linkTiles?.title" class="imgwidth"
                           (error)="getErrorImage(refImg,box.tile.linkTiles)"
                           #refImg>
                      <span *ngIf="box.tile.linkTiles?.showTitle && !box.tile.linkTiles?.displayLinkImage && !box.tile.linkTiles?.isManual"
                            class="text-center-v" [ngStyle]="{'color': box.tile.linkTiles.titleTextColor}"
                            popover="{{box.tile.linkTiles?.linkType=='Spell' ? box.tile.linkTiles?.spell?.spell?.name : box.tile.linkTiles?.linkType=='Ability' ? box.tile.linkTiles?.ability?.ability?.name : box.tile.linkTiles?.linkType=='BuffAndEffect' ? box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.linkTiles?.linkType=='Allies' ? box.tile.linkTiles?.ally?.name : box.tile.linkTiles?.linkType=='Item' ? box.tile.linkTiles?.item?.name : ''}}" triggers="hover" container="body"
                            [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey"
                            [style.line-height.px]="box.config.sizey==1?13:30+box.config.sizex+box.config.sizey"
                            [style.font-size.px]="box.config.sizey==1?13:15+box.config.sizex+box.config.sizey">
                        {{box.tile.linkTiles?.linkType=='Spell' ? box.tile.linkTiles?.spell?.spell?.name : box.tile.linkTiles?.linkType=='Ability' ? box.tile.linkTiles?.ability?.ability?.name : box.tile.linkTiles?.linkType=='BuffAndEffect' ? box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.linkTiles?.linkType=='Allies' ? box.tile.linkTiles?.ally?.name : box.tile.linkTiles?.linkType=='Item' ? box.tile.linkTiles?.item?.name : ''}}
                      </span>
                      <span *ngIf="box.tile.linkTiles?.showTitle && !box.tile.linkTiles?.displayLinkImage && box.tile.linkTiles?.isManual"
                            class="text-center-v" [ngStyle]="{'color': box.tile.linkTiles.titleTextColor}"
                            popover="{{box.tile.linkTiles?.linkType=='Spell' ? box.tile.linkTiles?.spell?.spell?.name : box.tile.linkTiles?.linkType=='Ability' ? box.tile.linkTiles?.ability?.ability?.name : box.tile.linkTiles?.linkType=='BuffAndEffect' ? box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.linkTiles?.linkType=='Allies' ? box.tile.linkTiles?.ally?.name : box.tile.linkTiles?.linkType=='Item' ? box.tile.linkTiles?.item?.name : ''}}" triggers="hover" container="body"
                            [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey"
                            [style.line-height.px]="box.config.sizey==1?13:30+box.config.sizex+box.config.sizey"
                            [style.font-size.px]="box.tile.linkTiles?.fontSize">
                        {{box.tile.linkTiles?.linkType=='Spell' ? box.tile.linkTiles?.spell?.spell?.name : box.tile.linkTiles?.linkType=='Ability' ? box.tile.linkTiles?.ability?.ability?.name : box.tile.linkTiles?.linkType=='BuffAndEffect' ? box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.linkTiles?.linkType=='Allies' ? box.tile.linkTiles?.ally?.name : box.tile.linkTiles?.linkType=='Item' ? box.tile.linkTiles?.item?.name : ''}}
                      </span>
                    </ng-container>

                    <ng-container *ngIf="!((box.tile.linkTiles?.linkType=='Spell' && box.tile.linkTiles?.spell?.spell?.name) ||
                                  (box.tile.linkTiles?.linkType=='Ability' && box.tile.linkTiles?.ability?.ability?.name) ||
                                  (box.tile.linkTiles?.linkType=='BuffAndEffect' && box.tile.linkTiles?.buffAndEffect?.buffAndEffect?.name) ||
                                  (box.tile.linkTiles?.linkType=='Item' && box.tile.linkTiles?.item?.name) ||
                                  (box.tile.linkTiles?.linkType=='Allies' && box.tile.linkTiles?.ally?.name))">
                      <span *ngIf="!box.tile.linkTiles?.isManual" class="text-center-v" [ngStyle]="{'color': box.tile.linkTiles.titleTextColor}"
                            [style.font-size.px]="box.config.sizey==1?13:15+box.config.sizex+box.config.sizey">
                        The targeted record has been removed
                      </span>
                      <span *ngIf="box.tile.linkTiles?.isManual" class="text-center-v" [ngStyle]="{'color': box.tile.linkTiles.titleTextColor}"
                            [style.font-size.px]="box.tile.linkTiles?.fontSize">
                        The targeted record has been removed
                      </span>
                    </ng-container>

                  </div>
                </div>
              </div>
              <!--exectutetile-->
              <div class="tile-group tile-group-item_counts tooltip1" *ngIf="box.tile.tileTypeId==TILES.EXECUTE && box.tile.executeTiles" [ngClass]="(box.tile.executeTiles?.shape=='50')?'grid-rounded':(box.tile.executeTiles?.shape=='100')?'grid-circle':''">
                <div class="tile tile-type-note tile-color-6"
                     [style.background-color]="box.tile.executeTiles?.bodyBgColor"
                     (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                     (mousedown)="editRecord(box.tile, box.tile.tileTypeId,i)" (mouseup)="clickAndHold(box.tile, box.tile.tileTypeId,i)" (mouseleave)="clickAndHold(box.tile, box.tile.tileTypeId,i)">

                  <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.executeTiles.titleTextColor, 'background-color': box.tile.executeTiles.titleBgColor}"
                      *ngIf="box.tile.executeTiles?.showTitle && box.tile.executeTiles?.displayLinkImage && !box.tile.executeTiles?.isManual"
                      popover="{{box.tile.executeTiles?.linkType=='Spell' ? box.tile.executeTiles?.spell?.spell?.name : box.tile.executeTiles?.linkType=='Ability' ? box.tile.executeTiles?.ability?.ability?.name : box.tile.executeTiles?.linkType=='BuffAndEffect' ? box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.executeTiles?.linkType=='Allies' ? box.tile.executeTiles?.ally?.name : box.tile.executeTiles?.linkType=='Item' ? box.tile.executeTiles?.item?.name : ''}}"
                      triggers="hover"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?13:15">
                    {{box.tile.executeTiles?.linkType=='Spell' ? box.tile.executeTiles?.spell?.spell?.name : box.tile.executeTiles?.linkType=='Ability' ? box.tile.executeTiles?.ability?.ability?.name : box.tile.executeTiles?.linkType=='BuffAndEffect' ? box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.executeTiles?.linkType=='Allies' ? box.tile.executeTiles?.ally?.name : box.tile.executeTiles?.linkType=='Item' ? box.tile.executeTiles?.item?.name : ''}}
                  </h5>
                  <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.executeTiles.titleTextColor, 'background-color': box.tile.executeTiles.titleBgColor}"
                      *ngIf="box.tile.executeTiles?.showTitle && box.tile.executeTiles?.displayLinkImage && box.tile.executeTiles?.isManual"
                      popover="{{box.tile.executeTiles?.linkType=='Spell' ? box.tile.executeTiles?.spell?.spell?.name : box.tile.executeTiles?.linkType=='Ability' ? box.tile.executeTiles?.ability?.ability?.name : box.tile.executeTiles?.linkType=='BuffAndEffect' ? box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.executeTiles?.linkType=='Allies' ? box.tile.executeTiles?.ally?.name : box.tile.executeTiles?.linkType=='Item' ? box.tile.executeTiles?.item?.name : ''}}"
                      triggers="hover"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.tile.executeTiles?.fontSizeTitle">
                    {{box.tile.executeTiles?.linkType=='Spell' ? box.tile.executeTiles?.spell?.spell?.name : box.tile.executeTiles?.linkType=='Ability' ? box.tile.executeTiles?.ability?.ability?.name : box.tile.executeTiles?.linkType=='BuffAndEffect' ? box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.executeTiles?.linkType=='Allies' ? box.tile.executeTiles?.ally?.name : box.tile.executeTiles?.linkType=='Item' ? box.tile.executeTiles?.item?.name : ''}}
                  </h5>
                  <!--Items Tile Detail-->
                  <div class="top1" *ngIf="box.tile.executeTiles?.linkType=='Item' && box.tile.executeTiles?.item?.name">
                    <div class="item-info mb-0">
                      <div class="container px-0">
                        <div class="item-info-wrapper">
                          <div class="item-info-top-section">
                            <div class="row">
                              <div class="col">
                                <div class="item-info-banner">
                                  <div class="item-info-image">
                                    <img class="card-img-top" [src]="box.tile.executeTiles?.item?.itemImage" [alt]="box.tile.executeTiles?.item?.name"
                                         onerror="this.src='../assets/images/DefaultImages/Item.jpg';" />
                                  </div>
                                  <h2 class="item-info-name mb-0">
                                    {{box.tile.executeTiles?.item?.name}}
                                  </h2>
                                  <div class="item-info-props-indics">
                                    <ul class="item-info-props">
                                      <li *ngIf="box.tile.executeTiles?.item?.rarity">{{box.tile.executeTiles?.item?.rarity}}</li>
                                      <li *ngIf="box.tile.executeTiles?.item?.value">{{box.tile.executeTiles?.item?.value}} {{box.tile.executeTiles?.item?.currencyLabel}}</li>
                                      <li *ngIf="box.tile.executeTiles?.item?.weight">{{box.tile.executeTiles?.item?.weight}} {{box.tile.executeTiles?.item?.weightLabel}}</li>
                                      <li *ngIf="box.tile.executeTiles?.item?.volume">{{box.tile.executeTiles?.item?.volume}} {{box.tile.executeTiles?.item?.volumeLabel}}</li>
                                    </ul>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-3 align-self-start">
                              <ul class="item-info-indics ml-3 w-100 mt-5 justify-content-start list-unstyled">
                                <li *ngIf="box.tile.executeTiles?.item?.isConsumable" title="Consumable" data-toggle="tooltip">
                                  <i class="item-property item-property-icon icon icon-Rec-consumable icon-ico"></i>
                                </li>
                                <li *ngIf="box.tile.executeTiles?.item?.isMagical" title="Magical" data-toggle="tooltip">
                                  <i class="item-property item-property-icon icon icon-Rec-Magical icon-ico"></i>
                                </li>
                                <li *ngIf="box.tile.executeTiles?.item?.isContainer" title="Container" data-toggle="tooltip">
                                  <i class="item-property item-property-icon icon icon-Rec-Container icon-ico"></i>
                                </li>
                              </ul>
                            </div>
                            <div class="col-9">
                              <div class="item-info-actions ml-0 h-100 w-100">
                                <div class="item-info-bottom-section px-2 pt-3">
                                  <div class="row">
                                    <div class="col-md-12">
                                      <div class="item-info-desc d-block mr-0">
                                        <h3>Description</h3>
                                        <p [froalaView]="box.tile.executeTiles?.item?.description"></p>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats ml-0">
                                        <h3>Stats</h3>
                                        <p [froalaView]="box.tile.executeTiles?.item?.itemStats"></p>
                                      </div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats mr-0">
                                        <h3>GM Only</h3>
                                        <p [froalaView]="box.tile.executeTiles?.item?.gmOnly"></p>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--Items Tile Detail-->
                  <!--Spell Tile Detail-->
                  <div class="top1" *ngIf="box.tile.executeTiles?.linkType=='Spell' && box.tile.executeTiles?.spell?.spell?.name">
                    <div class="item-info mb-0">
                      <div class="container px-0">
                        <div class="item-info-wrapper">
                          <div class="item-info-top-section">
                            <div class="row">
                              <div class="col">
                                <div class="item-info-banner">
                                  <div class="item-info-image">
                                    <img class="card-img-top" [src]="box.tile.executeTiles?.spell?.spell?.imageUrl" [alt]="box.tile.executeTiles?.spell?.spell?.name"
                                         onerror="this.src='../assets/images/DefaultImages/Spell.jpg';" />
                                  </div>
                                  <h2 class="item-info-name mb-0">
                                    {{box.tile.executeTiles?.spell?.spell?.name}}
                                  </h2>
                                  <!-- End of item name -->
                                  <div class="item-info-props-indics">
                                    <!-- Item properties -->
                                    <ul class="item-info-props">
                                      <li *ngIf="box.tile.executeTiles?.spell?.spell?.levels"> {{box.tile.executeTiles?.spell?.spell?.levels}} Level</li>
                                      <li *ngIf="box.tile.executeTiles?.spell?.spell?.castingTime"> {{box.tile.executeTiles?.spell?.spell?.castingTime}}</li>
                                    </ul>

                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-3 align-self-start">
                                    <ul class="item-info-indics ml-3 w-100 mt-5 justify-content-start">
                                      <li *ngIf="box.tile.executeTiles?.spell?.spell?.isSomaticComponent" class="icon"><i class="item-property item-property-icon icon-ico icon-Rec-Somantic"></i></li>
                                      <li *ngIf="box.tile.executeTiles?.spell?.spell?.isVerbalComponent" class="icon"><i class="item-property item-property-icon icon-ico icon-Rec-Verbal"></i></li>
                                      <li *ngIf="box.tile.executeTiles?.spell?.spell?.isMaterialComponent" class="icon"><i class="item-property item-property-icon icon-ico icon-Rec-Material icon-rsi"></i></li>
                                    </ul>
                                  </div>
                                  <div class="col-9">
                                    <div class="item-info-actions ml-0 h-100">
                                      <div class="item-info-bottom-section px-2 pt-3">
                                        <div class="form-row">
                                          <div class="col-md-12">
                                            <div class="item-info-command d-block mr-0">
                                              <h3>Description</h3>
                                              <p [froalaView]="box.tile.executeTiles?.spell?.spell?.description"></p>
                                            </div>
                                          </div>
                                        </div>
                                        <div class="row">
                                          <div class="col-12 col-md-6">
                                            <div class="item-info-stats ml-0">
                                              <h3>Stats</h3>
                                              <p [froalaView]="box.tile.executeTiles?.spell?.spell?.stats"></p>
                                            </div>
                                          </div>
                                          <div class="col-12 col-md-6">
                                            <div class="item-info-command mr-0">
                                              <h3>GM Only</h3>
                                              <p [froalaView]="box.tile.executeTiles?.spell?.spell?.gmOnly"></p>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>

                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--Spell Tile Detail-->
                  <!--Ability Tile Detail-->
                  <div class="top1" *ngIf="box.tile.executeTiles?.linkType=='Ability' && box.tile.executeTiles?.ability?.ability?.name">
                    <div class="item-info mb-0">
                      <div class="container px-0">
                        <div class="item-info-wrapper">
                          <div class="item-info-top-section">
                            <div class="row">
                              <div class="col">
                                <div class="item-info-banner">
                                  <div class="item-info-image">
                                    <img class="card-img-top" [src]="box.tile.executeTiles?.ability?.ability?.imageUrl" [alt]="box.tile.executeTiles?.ability?.ability?.name"
                                         onerror="this.src='../assets/images/DefaultImages/ability.jpg';" />
                                  </div>
                                  <h2 class="item-info-name mb-0">
                                    {{box.tile.executeTiles?.ability?.ability?.name}}
                                  </h2>
                                  <div class="item-info-props-indics">
                                    <ul class="item-info-props">
                                      <li *ngIf="box.tile.executeTiles?.ability?.ability?.level">{{box.tile.executeTiles?.ability?.ability?.level}} Level</li>
                                    </ul>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-3 align-self-start">
                              <ul class="item-info-indics ml-3 w-100 mt-5 justify-content-start list-unstyled">
                                <li *ngIf="box.tile.executeTiles?.ability?.ability?.isEnabled">
                                  <i class="icon icon-ico icon-Rec-Enabled"></i>
                                </li>
                              </ul>
                            </div>
                            <div class="col-9">
                              <div class="item-info-actions ml-0 h-100 w-100">
                                <div class="item-info-bottom-section px-2 pt-3">
                                  <div class="row">
                                    <div class="col-md-12">
                                      <div class="item-info-desc d-block mr-0">
                                        <h3>Description</h3>
                                        <p [froalaView]="box.tile.executeTiles?.ability?.ability?.description"></p>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats ml-0">
                                        <h3>Stats</h3>
                                        <p [froalaView]="box.tile.executeTiles?.ability?.ability?.stats"></p>
                                      </div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats mr-0">
                                        <h3>GM Only</h3>
                                        <p [froalaView]="box.tile.executeTiles?.ability?.ability?.gmOnly"></p>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--Ability Tile Detail-->
                  <!--BuffAndEffects Tile Detail-->
                  <div class="top1" *ngIf="box.tile.executeTiles?.linkType=='BuffAndEffect' && box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name">
                    <div class="item-info mb-0">
                      <div class="container px-0">
                        <div class="item-info-wrapper">
                          <div class="item-info-top-section">
                            <div class="row">
                              <div class="col">
                                <div class="item-info-banner">
                                  <div class="item-info-image">
                                    <img class="card-img-top" [src]="box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.imageUrl" [alt]="box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name"
                                         onerror="this.src='../assets/images/BnE/Def_BnE.jpg';" />
                                  </div>
                                  <h2 class="item-info-name mb-0">
                                    {{box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name}}
                                  </h2>
                                  <div class="item-info-props-indics">
                                    <ul class="item-info-props">
                                      <!--<li *ngIf="box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.level">{{box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.level}} Level</li>-->
                                    </ul>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-3 align-self-start">
                              <ul class="item-info-indics ml-3 w-100 mt-5 justify-content-start list-unstyled">
                                <!--<li *ngIf="box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.isEnabled">
                                  <i class="icon icon-ico icon-Rec-Enabled"></i>
                                </li>-->
                              </ul>
                            </div>
                            <div class="col-9">
                              <div class="item-info-actions ml-0 h-100 w-100">
                                <div class="item-info-bottom-section px-2 pt-3">
                                  <div class="row">
                                    <div class="col-md-12">
                                      <div class="item-info-desc d-block mr-0">
                                        <h3>Description</h3>
                                        <p [froalaView]="box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.description"></p>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats ml-0">
                                        <h3>Stats</h3>
                                        <p [froalaView]="box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.stats"></p>
                                      </div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats mr-0">
                                        <h3>GM Only</h3>
                                        <p [froalaView]="box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.gmOnly"></p>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--BuffAndEffects Tile Detail-->
                  <!--Allies Tile Detail-->
                  <div class="top1" *ngIf="box.tile.executeTiles?.linkType=='Allies' && box.tile.executeTiles?.ally?.name">
                    <div class="item-info mb-0">
                      <div class="container px-0">
                        <div class="item-info-wrapper">
                          <div class="item-info-top-section">
                            <div class="row">
                              <div class="col">
                                <div class="item-info-banner">
                                  <div class="item-info-image">
                                    <img class="card-img-top" [src]="box.tile.executeTiles?.ally?.imageUrl" [alt]="box.tile.executeTiles?.ally?.name"
                                         onerror="this.src='../assets/images/DefaultImages/monster.jpg';" />
                                  </div>
                                  <h2 class="item-info-name mb-0">
                                    {{box.tile.executeTiles?.ally?.name}}
                                  </h2>
                                  <div class="item-info-props-indics">
                                    <ul class="item-info-props">
                                      <li *ngIf="box.tile.executeTiles?.ally?.level">{{box.tile.executeTiles?.ally?.level}} Level</li>
                                      <li *ngIf="box.tile.executeTiles?.ally?.challangeRating">CR:{{box.tile.executeTiles?.ally?.challangeRating}}</li>
                                      <li *ngIf="box.tile.executeTiles?.ally?.armorClass">AC :{{box.tile.executeTiles?.ally?.armorClass}}</li>
                                      <li *ngIf="box.tile.executeTiles?.ally?.healthCurrent">{{box.tile.executeTiles?.ally?.healthCurrent}}/{{box.tile.executeTiles?.ally?.healthMax}}</li>
                                    </ul>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-3 align-self-start">
                              <ul class="item-info-indics ml-3 w-100 mt-5 justify-content-start list-unstyled">
                                <li *ngIf="box.tile.executeTiles?.ally?.isEnabled">
                                  <i class="icon icon-ico icon-Rec-Enabled"></i>
                                </li>
                                <li *ngIf="box.tile.executeTiles?.ally?.addToCombatTracker">
                                  <i class="icon icon-with-text icon-Combat icon-rsi"></i>
                                </li>
                              </ul>
                            </div>
                            <div class="col-9">
                              <div class="item-info-actions ml-0 h-100 w-100">
                                <div class="item-info-bottom-section px-2 pt-3">
                                  <div class="row">
                                    <div class="col-md-12">
                                      <div class="item-info-desc d-block mr-0">
                                        <h3>Description</h3>
                                        <p [froalaView]="box.tile.executeTiles?.ally?.description"></p>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats ml-0">
                                        <h3>Stats</h3>
                                        <p [froalaView]="box.tile.executeTiles?.ally?.stats"></p>
                                      </div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                      <div class="item-info-stats mr-0">
                                        <h3>GM Only</h3>
                                        <p [froalaView]="box.tile.executeTiles?.ally?.gmOnly"></p>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--Allies Tile Detail-->

                  <div class="tile-body" popover="{{box.tile.executeTiles?.linkType=='Spell' ? box.tile.executeTiles?.spell?.spell?.name : box.tile.executeTiles?.linkType=='Ability' ? box.tile.executeTiles?.ability?.ability?.name : box.tile.executeTiles?.linkType=='BuffAndEffect' ? box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.executeTiles?.linkType=='Allies' ? box.tile.executeTiles?.ally?.name : box.tile.executeTiles?.linkType=='Item' ? box.tile.executeTiles?.item?.name : ''}}"
                       [triggers]="!box.tile.executeTiles?.showTitle ? 'hover' : ''">
                    <ng-container *ngIf="!((box.tile.executeTiles?.linkType=='Spell' && box.tile.executeTiles?.spell?.spell?.name) ||
                                  (box.tile.executeTiles?.linkType=='Ability' && box.tile.executeTiles?.ability?.ability?.name) ||
                                  (box.tile.executeTiles?.linkType=='BuffAndEffect' && box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name) ||
                                  (box.tile.executeTiles?.linkType=='Item' && box.tile.executeTiles?.item?.name) ||
                                  (box.tile.executeTiles?.linkType=='Allies' && box.tile.executeTiles?.ally?.name))">
                      <span *ngIf="!box.tile.executeTiles?.isManual" class="text-center-v" [ngStyle]="{'color': box.tile.executeTiles.titleTextColor}"
                            [style.font-size.px]="box.config.sizey==1?13:15+box.config.sizex+box.config.sizey">
                        The targeted record has been removed
                      </span>
                      <span *ngIf="box.tile.executeTiles?.isManual" class="text-center-v" [ngStyle]="{'color': box.tile.executeTiles.titleTextColor}"
                            [style.font-size.px]="box.tile.executeTiles?.fontSize">
                        The targeted record has been removed
                      </span>
                    </ng-container>
                    <ng-container *ngIf="((box.tile.executeTiles?.linkType=='Spell' && box.tile.executeTiles?.spell?.spell?.name) ||
                                  (box.tile.executeTiles?.linkType=='Ability' && box.tile.executeTiles?.ability?.ability?.name) ||
                                  (box.tile.executeTiles?.linkType=='BuffAndEffect' && box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name) ||
                                  (box.tile.executeTiles?.linkType=='Item' && box.tile.executeTiles?.item?.name) ||
                                  (box.tile.executeTiles?.linkType=='Allies' && box.tile.executeTiles?.ally?.name))">
                      <img *ngIf="(box.tile.executeTiles?.showTitle && box.tile.executeTiles?.displayLinkImage) || (!box.tile.executeTiles?.showTitle && box.tile.executeTiles?.displayLinkImage)"
                           [src]="box.tile.executeTiles?.linkType=='Spell' ? box.tile.executeTiles?.spell?.spell?.imageUrl : box.tile.executeTiles?.linkType=='Ability' ? box.tile.executeTiles?.ability?.ability?.imageUrl : box.tile.executeTiles?.linkType=='BuffAndEffect' ? box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.imageUrl : box.tile.executeTiles?.linkType=='Allies' ? box.tile.executeTiles?.ally?.imageUrl : box.tile.executeTiles?.linkType=='Item' ? box.tile.executeTiles?.item?.itemImage : box.tile.executeTiles?.item?.itemImage"
                           [alt]="box.tile.executeTiles?.title" class="imgwidth"
                           (error)="getErrorImage(refImg,box.tile.executeTiles)"
                           #refImg>
                      <span *ngIf=" box.tile.executeTiles?.showTitle && !box.tile.executeTiles?.displayLinkImage && !box.tile.executeTiles?.isManual"
                            class="text-center-v" [ngStyle]="{'color': box.tile.executeTiles.titleTextColor}"
                            popover="{{box.tile.executeTiles?.linkType=='Spell' ? box.tile.linkTiles?.spell?.spell?.name : box.tile.executeTiles?.linkType=='Ability' ? box.tile.executeTiles?.ability?.ability?.name : box.tile.executeTiles?.linkType=='BuffAndEffect' ? box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.executeTiles?.linkType=='Allies' ? box.tile.executeTiles?.ally?.name : box.tile.executeTiles?.linkType=='Item' ? box.tile.executeTiles?.item?.name : ''}}" triggers="hover" container="body"
                            [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey"
                            [style.line-height.px]="box.config.sizey==1?13:30+box.config.sizex+box.config.sizey"
                            [style.font-size.px]="box.config.sizey==1?13:15+box.config.sizex+box.config.sizey">
                        {{box.tile.executeTiles?.linkType=='Spell' ? box.tile.executeTiles?.spell?.spell?.name : box.tile.executeTiles?.linkType=='Ability' ? box.tile.executeTiles?.ability?.ability?.name : box.tile.executeTiles?.linkType=='BuffAndEffect' ? box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.executeTiles?.linkType=='Allies' ? box.tile.executeTiles?.ally?.name : box.tile.executeTiles?.linkType=='Item' ? box.tile.executeTiles?.item?.name : ''}}
                      </span>
                      <span *ngIf=" box.tile.executeTiles?.showTitle && !box.tile.executeTiles?.displayLinkImage && box.tile.executeTiles?.isManual"
                            class="text-center-v" [ngStyle]="{'color': box.tile.executeTiles.titleTextColor}"
                            popover="{{box.tile.executeTiles?.linkType=='Spell' ? box.tile.linkTiles?.spell?.spell?.name : box.tile.executeTiles?.linkType=='Ability' ? box.tile.executeTiles?.ability?.ability?.name : box.tile.executeTiles?.linkType=='BuffAndEffect' ? box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.executeTiles?.linkType=='Allies' ? box.tile.executeTiles?.ally?.name : box.tile.executeTiles?.linkType=='Item' ? box.tile.executeTiles?.item?.name : ''}}" triggers="hover" container="body"
                            [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey"
                            [style.line-height.px]="box.config.sizey==1?13:30+box.config.sizex+box.config.sizey"
                            [style.font-size.px]="box.tile.executeTiles?.fontSize">
                        {{box.tile.executeTiles?.linkType=='Spell' ? box.tile.executeTiles?.spell?.spell?.name : box.tile.executeTiles?.linkType=='Ability' ? box.tile.executeTiles?.ability?.ability?.name : box.tile.executeTiles?.linkType=='BuffAndEffect' ? box.tile.executeTiles?.buffAndEffect?.buffAndEffect?.name : box.tile.executeTiles?.linkType=='Allies' ? box.tile.executeTiles?.ally?.name : box.tile.executeTiles?.linkType=='Item' ? box.tile.executeTiles?.item?.name : ''}}
                      </span>
                    </ng-container>

                  </div>
                </div>
              </div>

              <div class="tile-group tile-group-item_counts" *ngIf="box.tile.tileTypeId==TILES.COMMAND && box.tile.commandTiles" [ngClass]="(box.tile.commandTiles?.shape=='50')?'grid-rounded':(box.tile.commandTiles?.shape=='100')?'grid-circle':''">
                <div class="tile tile-type-image tile-color-6" [style.background-color]="box.tile.commandTiles?.title && box.tile.commandTiles?.imageUrl?.trim()?box.tile.commandTiles?.bodyBgColor:box.tile.commandTiles?.titleBgColor" (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                     (mousedown)="editRecord(box.tile, box.tile.tileTypeId,i)" (mouseup)="clickAndHold(box.tile, box.tile.tileTypeId,i)" (mouseleave)="clickAndHold(box.tile, box.tile.tileTypeId,i)">
                  <h5 *ngIf="box.tile.commandTiles?.title && box.tile.commandTiles?.imageUrl?.trim() && !box.tile.commandTiles?.isManual" class="tile-title wraptext" [ngStyle]="{'color': box.tile.commandTiles.titleTextColor, 'background-color': box.tile.commandTiles.titleBgColor}"
                      popover="{{box.tile.commandTiles?.title}}" triggers="hover" container="body"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?13:15">
                    {{box.tile.commandTiles?.title}}
                  </h5>
                  <h5 *ngIf="box.tile.commandTiles?.title && box.tile.commandTiles?.imageUrl?.trim() && box.tile.commandTiles?.isManual" class="tile-title wraptext" [ngStyle]="{'color': box.tile.commandTiles.titleTextColor, 'background-color': box.tile.commandTiles.titleBgColor}"
                      popover="{{box.tile.commandTiles?.title}}" triggers="hover" container="body"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.tile.commandTiles?.fontSizeTitle">
                    {{box.tile.commandTiles?.title}}
                  </h5>

                  <div class="tile-body  text-overflow-hidden">

                    <img *ngIf="box.tile.commandTiles?.imageUrl" [src]="box.tile.commandTiles?.imageUrl" [alt]="box.tile.commandTiles?.title"
                         class="imgwidth" onerror="this.src='https://rpgsmithsa.blob.core.windows.net/stock-icons/d20.png';">

                    <!--<span *ngIf="(box.tile.commandTiles?.title || box.tile.commandTiles?.command) && !box.tile.commandTiles?.imageUrl" class="text-center-v" [ngStyle]="{'color': box.tile.commandTiles.titleTextColor, 'background-color': box.tile.commandTiles.titleBgColor}"
                          popover="{{box.tile.commandTiles?.title ? box.tile.commandTiles?.title : box.tile.commandTiles?.command}}" triggers="hover" container="body"
                          [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey" [style.line-height.px]="box.config.sizey==1?13:30+box.config.sizex+box.config.sizey" [style.font-size.px]="box.config.sizey==1?13:15+box.config.sizex+box.config.sizey">
                      {{box.tile.commandTiles?.title ? box.tile.commandTiles?.title : box.tile.commandTiles?.command}}
                    </span>-->
                    <span *ngIf="(box.tile.commandTiles?.title || box.tile.commandTiles?.command) && !box.tile.commandTiles?.imageUrl && !box.tile.commandTiles?.isManual" class="text-center-v overlap-text-break" [ngStyle]="{'color': box.tile.commandTiles.titleTextColor, 'background-color': box.tile.commandTiles.titleBgColor}"
                          popover="{{box.tile.commandTiles?.title ? box.tile.commandTiles?.title : box.tile.commandTiles?.command}}" triggers="hover" container="body"
                          [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey" [style.font-size.px]="box.config.sizey==1?13:15+box.config.sizex+box.config.sizey">
                      {{box.tile.commandTiles?.title ? box.tile.commandTiles?.title : box.tile.commandTiles?.command}}
                    </span>
                    <span *ngIf="(box.tile.commandTiles?.title || box.tile.commandTiles?.command) && !box.tile.commandTiles?.imageUrl && box.tile.commandTiles?.isManual" class="text-center-v overlap-text-break" [ngStyle]="{'color': box.tile.commandTiles.titleTextColor, 'background-color': box.tile.commandTiles.titleBgColor}"
                          popover="{{box.tile.commandTiles?.title ? box.tile.commandTiles?.title : box.tile.commandTiles?.command}}" triggers="hover" container="body"
                          [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey" [style.font-size.px]="box.tile.commandTiles?.fontSize">
                      {{box.tile.commandTiles?.title ? box.tile.commandTiles?.title : box.tile.commandTiles?.command}}
                    </span>

                  </div>
                </div>
              </div>

              <div class="tile-group tile-group-item_counts" *ngIf="box.tile.tileTypeId==TILES.TEXT && box.tile.textTiles" [ngClass]="(box.tile.textTiles?.shape=='50')?'grid-rounded':(box.tile.textTiles?.shape=='100')?'grid-circle':''">
                <div class="tile tile-type-note" [style.background-color]="box.tile.textTiles?.bodyBgColor" (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                     (mousedown)="editRecord(box.tile, box.tile.tileTypeId,i)" (mouseup)="clickAndHold(box.tile, box.tile.tileTypeId,i)" (mouseleave)="clickAndHold(box.tile, box.tile.tileTypeId,i)">
                  <h5 *ngIf="box.tile.textTiles?.title && !box.tile.textTiles?.isManualTitle" class="tile-title wraptext" [ngStyle]="{'color': box.tile.textTiles.titleTextColor, 'background-color': box.tile.textTiles.titleBgColor}"
                      popover="{{box.tile.textTiles?.title}}" triggers="hover" container="body"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?13:15">
                    {{box.tile.textTiles?.title}}
                  </h5>
                  <h5 *ngIf="box.tile.textTiles?.title && box.tile.textTiles?.isManualTitle" class="tile-title wraptext" [ngStyle]="{'color': box.tile.textTiles.titleTextColor, 'background-color': box.tile.textTiles.titleBgColor}"
                      popover="{{box.tile.textTiles?.title}}" triggers="hover" container="body"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.tile.textTiles?.fontSizeTitle">
                    {{box.tile.textTiles?.title}}
                  </h5>

                  <div class="tile-body" *ngIf="!box.tile.textTiles?.isManualText">
                    <span class="text-center-v"
                          [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)"
                          [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)"
                          [style.color]="box.tile.textTiles.bodyTextColor"
                          [style.background-color]="box.tile.textTiles.bodyBgColor">
                      {{box.tile.textTiles?.displaytext ? box.tile.textTiles?.displaytext : box.tile.textTiles?.text}}
                    </span>
                  </div>
                  <div class="tile-body" *ngIf="box.tile.textTiles?.isManualText">
                    <span class="text-center-v"
                          [style.font-size.px]="box.tile.textTiles?.fontSizeText"
                          [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)"
                          [style.color]="box.tile.textTiles.bodyTextColor"
                          [style.background-color]="box.tile.textTiles.bodyBgColor">
                      {{box.tile.textTiles?.displaytext ? box.tile.textTiles?.displaytext : box.tile.textTiles?.text}}
                    </span>
                  </div>
                </div>
              </div>

              <div class="tile-group tile-group-item_counts" *ngIf="box.tile.tileTypeId==TILES.BUFFANDEFFECT && box.tile.buffAndEffectTiles" [ngClass]="(box.tile.buffAndEffectTiles?.shape=='50')?'grid-rounded':(box.tile.buffAndEffectTiles?.shape=='100')?'grid-circle':''">
                <div class="tile tile-type-note tile-color-6"
                     [style.background-color]="box.tile.buffAndEffectTiles?.bodyBgColor"
                     [ngClass]="{'grid-rounded':(box.tile.buffAndEffectTiles?.shape=='50'),'grid-circle':(box.tile.buffAndEffectTiles?.shape=='100'),'buff-padding':!(box.tile.buffAndEffectTiles?.title),'buff-padding-1-tile':(!(box.tile.buffAndEffectTiles?.title) && (box.config.sizex==1)),'buff-padding-2-tiles':(!(box.tile.buffAndEffectTiles?.title) && (box.config.sizex==2)),'buff-padding-2-plus-tiles':(!(box.tile.buffAndEffectTiles?.title) && (box.config.sizex>=3))}"
                     (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                     (mousedown)="editRecord(box.tile, box.tile.tileTypeId,i)" (mouseup)="clickAndHold(box.tile, box.tile.tileTypeId,i)" (mouseleave)="clickAndHold(box.tile, box.tile.tileTypeId,i)">
                  <ng-container *ngIf="box.tile.buffAndEffectTiles?.title && !box.tile.buffAndEffectTiles?.isManual">
                    <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.buffAndEffectTiles.titleTextColor, 'background-color': box.tile.buffAndEffectTiles.titleBgColor}"
                        popover="{{box.tile.buffAndEffectTiles?.title}}" triggers="hover" container="body"
                        [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?10:12">
                      {{box.tile.buffAndEffectTiles?.title}}
                    </h5>
                  </ng-container>
                  <ng-container *ngIf="box.tile.buffAndEffectTiles?.title && box.tile.buffAndEffectTiles?.isManual">
                    <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.buffAndEffectTiles.titleTextColor, 'background-color': box.tile.buffAndEffectTiles.titleBgColor}"
                        popover="{{box.tile.buffAndEffectTiles?.title}}" triggers="hover" container="body"
                        [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.tile.buffAndEffectTiles?.fontSizeTitle">
                      {{box.tile.buffAndEffectTiles?.title}}
                    </h5>
                  </ng-container>


                  <div class="tile-body buff-tile-body"
                       [ngClass]="{'pt-3':((box.tile.buffAndEffectTiles?.title) && (box.config.sizey!=1)),'buff-padding':(box.tile.buffAndEffectTiles?.title),'buff-with-title-padding-1-tile':((box.tile.buffAndEffectTiles?.title) && (box.config.sizex==1)),'buff-with-title-padding-2-tiles':((box.tile.buffAndEffectTiles?.title) && (box.config.sizex==2)),'buff-with-title-padding-2-plus-tiles':((box.tile.buffAndEffectTiles?.title) && (box.config.sizex>=3))}"
                       (click)="AssignBuffsToCharacter(box.tile.buffAndEffectTiles?.multiBuffAndEffectsIds)">
                    <ng-container *ngIf="box.tile.buffAndEffectTiles?.showTitle && !box.tile.buffAndEffectTiles?.displayLinkImage && !box.tile.buffAndEffectTiles?.isManual">
                      <span [ngStyle]="{'color': box.tile.buffAndEffectTiles.titleTextColor}"
                            [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey"
                            [style.line-height.px]="box.config.sizey==1?13:20+box.config.sizex+box.config.sizey-(box.tile.buffAndEffectTiles?.title ? 2:0)"
                            [style.font-size.px]="box.config.sizey==1?13:15+box.config.sizex+box.config.sizey-(box.tile.buffAndEffectTiles?.title ? 2:0)">
                        <ng-container *ngFor="let CharBuff of box.tile.buffAndEffectTiles?.multiBuffAndEffectsIds; let i = index">
                          <span class="buff-text-only " *ngIf="CharBuff?.buffAndEffect"
                                title="{{description(CharBuff?.buffAndEffect?.description)}}"
                                [routerLink]="['/character/buff-effect-details/', CharBuff?.characterBuffAandEffectId]">
                            {{CharBuff?.buffAndEffect?.name}}{{(i+1)!=box.tile.buffAndEffectTiles?.multiBuffAndEffectsIds?.length ?',&nbsp;':''}}
                          </span>
                        </ng-container>
                      </span>
                    </ng-container>
                    <ng-container *ngIf="box.tile.buffAndEffectTiles?.showTitle && !box.tile.buffAndEffectTiles?.displayLinkImage && box.tile.buffAndEffectTiles?.isManual">
                      <span [ngStyle]="{'color': box.tile.buffAndEffectTiles.titleTextColor}"
                            [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey"
                            [style.line-height.px]="box.config.sizey==1?13:20+box.config.sizex+box.config.sizey-(box.tile.buffAndEffectTiles?.title ? 2:0)"
                            [style.font-size.px]="box.tile.buffAndEffectTiles?.fontSize">
                        <ng-container *ngFor="let CharBuff of box.tile.buffAndEffectTiles?.multiBuffAndEffectsIds; let i = index">
                          <span class="buff-text-only " *ngIf="CharBuff?.buffAndEffect"
                                title="{{description(CharBuff?.buffAndEffect?.description)}}"
                                [routerLink]="['/character/buff-effect-details/', CharBuff?.characterBuffAandEffectId]">
                            {{CharBuff?.buffAndEffect?.name}}{{(i+1)!=box.tile.buffAndEffectTiles?.multiBuffAndEffectsIds?.length ?',&nbsp;':''}}
                          </span>
                        </ng-container>
                      </span>
                    </ng-container>

                    <ng-container *ngIf="box.tile.buffAndEffectTiles?.showTitle && box.tile.buffAndEffectTiles?.displayLinkImage">
                      <span class="buff-image-text-both" [ngStyle]="{'color': box.tile.buffAndEffectTiles.titleTextColor}"
                            [style.height.px]="getTileSize().max"
                            [ngClass]="{'buff-tile-font-7':(box.config.sizex<=2),'buff-tile-font-12':(box.config.sizex==3),'buff-tile-font-20':(box.config.sizex==4),'buff-tile-font-24':(box.config.sizex==5),'buff-tile-font-27':(box.config.sizex==6),'buff-tile-font-29':(box.config.sizex==7),'buff-tile-font-30':(box.config.sizex==8),'buff-tile-font-31':(box.config.sizex==9),'buff-tile-font-32':(box.config.sizex==10 || box.config.sizex==11),'buff-tile-font-33':(box.config.sizex==12 || box.config.sizex==13),'buff-tile-font-34':(box.config.sizex>=14)}">
                        <ng-container *ngFor="let CharBuff of box.tile.buffAndEffectTiles?.multiBuffAndEffectsIds; let i = index">
                          <div class="inline-buff-image box-img"
                               [ngClass]="{'buff-with-title-box-margin-11-0-13-0':((box.tile.buffAndEffectTiles?.title) && (box.config.sizey==2)),'buff-with-title-box-margin-11-0-0-0':((box.tile.buffAndEffectTiles?.title) && (box.config.sizey==3)),'buff-with-title-box-margin-11-0-0-0':((box.tile.buffAndEffectTiles?.title) && (box.config.sizey>=3 && box.config.sizey<=4)),'buff-with-title-box-margin-7-0-0-0':((box.tile.buffAndEffectTiles?.title) && (box.config.sizey>=5 && box.config.sizey<=7)),'buff-with-title-box-margin-5-0-0-0':((box.tile.buffAndEffectTiles?.title) && (box.config.sizey>=8))}"
                               [ngStyle]="{'width': (getTileSize().max)+'px', 'height': (box.config.sizey<3?getTileSize().max:getTileSize().max+box.config.sizey+1)+'px'}"
                               title="{{description(CharBuff?.buffAndEffect?.description)}}"
                               [routerLink]="['/character/buff-effect-details/', CharBuff?.characterBuffAandEffectId]">
                            <img *ngIf="CharBuff?.buffAndEffect" [src]="CharBuff?.buffAndEffect?.imageUrl" class="buff-tile-image"
                                 [ngStyle]="{'width': ((getTileSize().max-4)<24?24 :(getTileSize().max-4))+'px','height': ((getTileSize().max-26)<24?24 :(getTileSize().max-26))+'px'}"
                                 popover="{{CharBuff?.buffAndEffect?.name}}" triggers="hover" container="body" />
                            <p *ngIf="!box.tile.buffAndEffectTiles?.isManual" [style.font-size.px]="box.config.sizey==1?10:8+box.config.sizex+box.config.sizey">{{CharBuff?.buffAndEffect?.name}}</p>
                            <p *ngIf="box.tile.buffAndEffectTiles?.isManual" [style.font-size.px]="box.tile.buffAndEffectTiles?.fontSize">{{CharBuff?.buffAndEffect?.name}}</p>
                          </div>
                        </ng-container>
                      </span>
                    </ng-container>
                    <ng-container *ngIf="!box.tile.buffAndEffectTiles?.showTitle && box.tile.buffAndEffectTiles?.displayLinkImage">
                      <span class="buff-images-only" [ngStyle]="{'color': box.tile.buffAndEffectTiles.titleTextColor}"
                            [style.height.px]="getTileSize().max"
                            [ngClass]="{'buff-tile-font-7':(box.config.sizex<=2),'buff-tile-font-12':(box.config.sizex==3),'buff-tile-font-20':(box.config.sizex==4),'buff-tile-font-24':(box.config.sizex==5),'buff-tile-font-27':(box.config.sizex==6),'buff-tile-font-29':(box.config.sizex==7),'buff-tile-font-30':(box.config.sizex==8),'buff-tile-font-31':(box.config.sizex==9),'buff-tile-font-32':(box.config.sizex==10 || box.config.sizex==11),'buff-tile-font-33':(box.config.sizex==12 || box.config.sizex==13),'buff-tile-font-34':(box.config.sizex>=14)}">
                        <ng-container *ngFor="let CharBuff of box.tile.buffAndEffectTiles?.multiBuffAndEffectsIds; let i = index">
                          <div class="inline-buff-image"
                               [ngClass]="{'buff-with-title-box-margin-11-0-13-0':((box.tile.buffAndEffectTiles?.title) && (box.config.sizey==2)),'buff-with-title-box-margin-11-0-0-0':((box.tile.buffAndEffectTiles?.title) && (box.config.sizey==3)),'buff-with-title-box-margin-11-0-0-0':((box.tile.buffAndEffectTiles?.title) && (box.config.sizey>=3 && box.config.sizey<=4)),'buff-with-title-box-margin-7-0-0-0':((box.tile.buffAndEffectTiles?.title) && (box.config.sizey>=5 && box.config.sizey<=7)),'buff-with-title-box-margin-5-0-0-0':((box.tile.buffAndEffectTiles?.title) && (box.config.sizey>=8))}">
                            <div class="buff-image-div"
                                 [ngClass]="{'buff-image-padding-5': (box.config.sizey==1 || (box.config.sizey==1 && box.config.sizex==1))}"
                                 [ngStyle]="{'width': (getTileSize().max)+'px', 'height': (box.config.sizey<3?getTileSize().max:getTileSize().max + (box.config.sizey/2.5)+1)+'px'}">
                              <img *ngIf="CharBuff?.buffAndEffect" [src]="CharBuff?.buffAndEffect?.imageUrl" class="buff-tile-image"
                                   popover="{{CharBuff?.buffAndEffect?.name}}" triggers="hover" container="body"
                                   title="{{description(CharBuff?.buffAndEffect?.description)}}"
                                   [ngClass]="{'buff-image-padding-bottom-10': (box.config.sizey==1 || (box.config.sizey==1 && box.config.sizex==1))}"
                                   [routerLink]="['/character/buff-effect-details/', CharBuff?.characterBuffAandEffectId]" />
                            </div>
                          </div>

                        </ng-container>
                      </span>
                    </ng-container>

                  </div>
                </div>
              </div>

              <div class="tile-group tile-group-item_counts" *ngIf="box.tile.tileTypeId==TILES.TOGGLE && box.tile.toggleTiles" [ngClass]="(box.tile.toggleTiles?.shape=='50')?'grid-rounded':(box.tile.toggleTiles?.shape=='100')?'grid-circle':''">
                <div class="tile tile-type-note" [style.background-color]="box.tile.toggleTiles?.bodyBgColor" (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                     (mousedown)="editRecord(box.tile, box.tile.tileTypeId,i)" (mouseup)="clickAndHold(box.tile, box.tile.tileTypeId,i)" (mouseleave)="clickAndHold(box.tile, box.tile.tileTypeId,i)">
                  <h5 *ngIf="box.tile.toggleTiles?.title && !box.tile.toggleTiles?.isManual" class="tile-title wraptext" [ngStyle]="{'color': box.tile.toggleTiles.titleTextColor, 'background-color': box.tile.toggleTiles.titleBgColor}"
                      popover="{{box.tile.toggleTiles?.title}}" triggers="hover" container="body"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?13:15">
                    {{box.tile.toggleTiles?.title}}
                  </h5>
                  <h5 *ngIf="box.tile.toggleTiles?.title && box.tile.toggleTiles?.isManual" class="tile-title wraptext" [ngStyle]="{'color': box.tile.toggleTiles.titleTextColor, 'background-color': box.tile.toggleTiles.titleBgColor}"
                      popover="{{box.tile.toggleTiles?.title}}" triggers="hover" container="body"
                      [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.tile.toggleTiles?.fontSizeTitle">
                    {{box.tile.toggleTiles?.title}}
                  </h5>

                  <div class="tile-body text-overflow-hidden">
                    <div [ngClass]="(box.tile.toggleTiles?.shape=='50')?'grid-rounded':''" [style.color]="box.tile.toggleTiles.bodyTextColor"
                         [style.background-color]="box.tile.toggleTiles.bodyBgColor">

                      <ng-container *ngIf="!box.tile.toggleTiles?.isManual">
                        <ng-container *ngIf="box.tile.toggleTiles?.tileToggle?.yesNo">
                          <span [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v noselect">{{box.tile.toggleTiles?.yesNo ? 'YES' : 'NO'}}</span>
                        </ng-container>
                        <ng-container *ngIf="box.tile.toggleTiles?.tileToggle?.onOff">
                          <span [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v noselect">{{box.tile.toggleTiles?.onOff ? 'ON' : 'OFF'}}</span>
                        </ng-container>
                        <ng-container *ngIf="box.tile.toggleTiles?.tileToggle?.display">
                          <span *ngIf="box.tile.toggleTiles?.checkBox" [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v icon-Gen-Check noselect"></span>
                          <span *ngIf="!box.tile.toggleTiles?.checkBox" [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v icon-Gen-Uncheck noselect"></span>
                        </ng-container>

                        <ng-container *ngIf="box.tile.toggleTiles?.tileToggle?.isCustom">
                          <ng-container *ngIf="box.tile.toggleTiles?.tileToggle?.tileCustomToggles?.length">
                            <ng-container *ngFor="let toggleVal of box.tile.toggleTiles?.tileToggle?.tileCustomToggles; let i = index">
                              <ng-container *ngIf="toggleVal.initial">
                                <ng-container *ngIf="toggleVal.toggleText">
                                  <!--<p class="noselect" [style.color]="box.tile.toggleTiles.bodyTextColor"
                                     [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                    {{toggleVal.toggleText}}
                                  </p>-->
                                  <span class="noselect text-center-v" [style.color]="box.tile.toggleTiles.bodyTextColor"
                                        [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                    {{toggleVal.toggleText}}
                                  </span>
                                </ng-container>
                                <ng-container *ngIf="toggleVal.image">
                                  <img class="imgwidth" [src]="toggleVal.image" onerror="this.src = 'https://rpgsmithsa.blob.core.windows.net/stock-defimg-rulesets/RS.png';" />
                                </ng-container>
                              </ng-container>

                            </ng-container>
                          </ng-container>
                        </ng-container>

                      </ng-container>
                      <ng-container *ngIf="box.tile.toggleTiles?.isManual">
                        <ng-container *ngIf="box.tile.toggleTiles?.tileToggle?.yesNo">
                          <span [style.font-size.px]="box.tile.toggleTiles?.fontSize" class="text-center-v noselect">{{box.tile.toggleTiles?.yesNo ? 'YES' : 'NO'}}</span>
                        </ng-container>
                        <ng-container *ngIf="box.tile.toggleTiles?.tileToggle?.onOff">
                          <span [style.font-size.px]="box.tile.toggleTiles?.fontSize" class="text-center-v noselect">{{box.tile.toggleTiles?.onOff ? 'ON' : 'OFF'}}</span>
                        </ng-container>
                        <ng-container *ngIf="box.tile.toggleTiles?.tileToggle?.display">
                          <span *ngIf="box.tile.toggleTiles?.checkBox" [style.font-size.px]="box.tile.toggleTiles?.fontSize" class="text-center-v icon-Gen-Check noselect"></span>
                          <span *ngIf="!box.tile.toggleTiles?.checkBox" [style.font-size.px]="box.tile.toggleTiles?.fontSize" class="text-center-v icon-Gen-Uncheck noselect"></span>
                        </ng-container>

                        <ng-container *ngIf="box.tile.toggleTiles?.tileToggle?.isCustom">
                          <ng-container *ngIf="box.tile.toggleTiles?.tileToggle?.tileCustomToggles?.length">
                            <ng-container *ngFor="let toggleVal of box.tile.toggleTiles?.tileToggle?.tileCustomToggles; let i = index">
                              <ng-container *ngIf="toggleVal.initial">
                                <ng-container *ngIf="toggleVal.toggleText">
                                  <span class="noselect text-center-v" [style.color]="box.tile.toggleTiles.bodyTextColor"
                                        [style.font-size.px]="box.tile.toggleTiles?.fontSize" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                    {{toggleVal.toggleText}}
                                  </span>
                                </ng-container>
                                <ng-container *ngIf="toggleVal.image">
                                  <img class="imgwidth" [src]="toggleVal.image" onerror="this.src = 'https://rpgsmithsa.blob.core.windows.net/stock-defimg-rulesets/RS.png';" />
                                </ng-container>
                              </ng-container>

                            </ng-container>
                          </ng-container>
                        </ng-container>

                      </ng-container>
                    </div>
                  </div>
                </div>
              </div>

              <!--Currency Tile-->
              <!--/////////////////////////////-->
              <div class="tile-group tile-group-item_counts" *ngIf="box.tile.tileTypeId==TILES.CURRENCY && box.tile.currencyTile" [ngClass]="(box.tile.currencyTile?.shape=='50')?'grid-rounded':(box.tile.currencyTile?.shape=='100')?'grid-circle':''">
                <div class="tile tile-type-note tile-color-6"
                     [style.background-color]="box.tile.currencyTile?.bodyBgColor"
                     [ngClass]="{'grid-rounded':(box.tile.currencyTile?.shape=='50'),'grid-circle':(box.tile.currencyTile?.shape=='100'),'buff-padding':!(box.tile.currencyTile?.title),'buff-padding-1-tile':(!(box.tile.currencyTile?.title) && (box.config.sizex==1)),'buff-padding-2-tiles':(!(box.tile.currencyTile?.title) && (box.config.sizex==2)),'buff-padding-2-plus-tiles':(!(box.tile.currencyTile?.title) && (box.config.sizex>=3))}"
                     (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                     (mousedown)="editRecord(box.tile, box.tile.tileTypeId,i)" (mouseup)="clickAndHold(box.tile, box.tile.tileTypeId,i)" (mouseleave)="clickAndHold(box.tile, box.tile.tileTypeId,i)">
                  <ng-container *ngIf="box.tile.currencyTile?.title && !box.tile.currencyTile?.isManual">
                    <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.currencyTile.titleTextColor, 'background-color': box.tile.currencyTile.titleBgColor}"
                        popover="{{box.tile.currencyTile?.title}}" triggers="hover" container="body"
                        [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?10:12">
                      {{box.tile.currencyTile?.title}}
                    </h5>
                  </ng-container>
                  <ng-container *ngIf="box.tile.currencyTile?.title && box.tile.currencyTile?.isManual">
                    <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.currencyTile.titleTextColor, 'background-color': box.tile.currencyTile.titleBgColor}"
                        popover="{{box.tile.currencyTile?.title}}" triggers="hover" container="body"
                        [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.tile.currencyTile?.fontSizeTitle">
                      {{box.tile.currencyTile?.title}}
                    </h5>
                  </ng-container>

                  <div class="tile-body buff-tile-body ml-1 pt-1" *ngIf="!box.tile.currencyTile?.isManual">
                    <span [ngStyle]="{'color': box.tile.currencyTile.titleTextColor}"
                          [style.height.px]="box.config.sizey==1?10:30+box.config.sizex+box.config.sizey"
                          [style.line-height.px]="box.config.sizey==1?8:15+box.config.sizex+box.config.sizey-(box.tile.currencyTile?.title ? 2:0)"
                          [style.font-size.px]="box.config.sizey==1?11:13+box.config.sizex+box.config.sizey-(box.tile.currencyTile?.title ? 2:0)">
                      <ng-container *ngFor="let CCurrency of box.tile.currencyTile?.characterCurrency; let i = index">
                        <span class="w-100 d-block margin-bottom">
                          <span class="currncyName text-white border px-1">{{CCurrency.amount}}</span>
                          <span class="currncyName text-white">{{CCurrency.name}}</span>
                        </span>
                      </ng-container>
                    </span>
                  </div>
                  <div class="tile-body buff-tile-body ml-1 pt-1" *ngIf="box.tile.currencyTile?.isManual">
                    <span [ngStyle]="{'color': box.tile.currencyTile.titleTextColor}"
                          [style.height.px]="box.config.sizey==1?10:30+box.config.sizex+box.config.sizey"
                          [style.line-height.px]="box.config.sizey==1?8:15+box.config.sizex+box.config.sizey-(box.tile.currencyTile?.title ? 2:0)"
                          [style.font-size.px]="box.tile.currencyTile?.fontSize">
                      <ng-container *ngFor="let CCurrency of box.tile.currencyTile?.characterCurrency; let i = index">
                        <span class="w-100 d-block margin-bottom">
                          <span class="currncyName text-white border px-1">{{CCurrency.amount}}</span>
                          <span class="currncyName text-white">{{CCurrency.name}}</span>
                        </span>
                      </ng-container>
                    </span>
                  </div>
                </div>
              </div>
              <!--/////////////////////////////-->
              <!--<div class="tile-group tile-group-item_counts" *ngIf="box.tile.tileTypeId==TILES.CURRENCY && box.tile.currencyTile" [ngClass]="(box.tile.currencyTile?.shape=='50')?'grid-rounded':(box.tile.currencyTile?.shape=='100')?'grid-circle':''">
                <div class="tile tile-type-note tile-color-6"
                     [style.background-color]="box.tile.currencyTile?.bodyBgColor"
                     [ngClass]="{'grid-rounded':(box.tile.currencyTile?.shape=='50'),'grid-circle':(box.tile.currencyTile?.shape=='100'),'buff-padding':!(box.tile.currencyTile?.title),'buff-padding-1-tile':(!(box.tile.currencyTile?.title) && (box.config.sizex==1)),'buff-padding-2-tiles':(!(box.tile.currencyTile?.title) && (box.config.sizex==2)),'buff-padding-2-plus-tiles':(!(box.tile.currencyTile?.title) && (box.config.sizex>=3))}"
                     (click)="viewTile(box.tile, box.tile.tileTypeId, $event)">
                  <ng-container *ngIf="box.tile.currencyTile?.title">
                    <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.currencyTile.titleTextColor, 'background-color': box.tile.currencyTile.titleBgColor}"
                        popover="{{box.tile.currencyTile?.title}}" triggers="hover" container="body"
                        [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?10:12">
                      {{box.tile.currencyTile?.title}}
                    </h5>
                  </ng-container>
                  <div class="form-group output-list output-list-wrap">
                    <ul class="output-list-items pt-1 px-1">
                      <li class="output-list-item mb-0" *ngFor="let CCurrency of box.tile.currencyTile?.characterCurrency">
                        <span class="curncyTile text-white border px-1">{{CCurrency.amount}}</span>
                        <span class="currncyName text-white">{{CCurrency.name}}</span>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>-->

              <ng-container *ngIf="box.tile.tileTypeId==TILES.CHARACTERSTATCLUSTER && box.tile.characterStatClusterTiles">
                <div *ngIf="box.tile.characterStatClusterTiles?.title && !box.tile.characterStatClusterTiles?.displayCharactersCharacterStatID"
                     class="tile-group tile-group-item_counts"
                     [ngClass]="(box.tile.characterStatClusterTiles?.shape=='50')?'grid-rounded':(box.tile.characterStatClusterTiles?.shape=='100')?'grid-circle':''">
                  <div class="tile tile-type-note" [style.background-color]="box.tile.characterStatClusterTiles?.bodyBgColor" (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                       (mousedown)="editRecord(box.tile, box.tile.tileTypeId,i)" (mouseup)="clickAndHold(box.tile, box.tile.tileTypeId,i)" (mouseleave)="clickAndHold(box.tile, box.tile.tileTypeId,i)">
                    <!--<h5 class="tile-title wraptext"
                        [ngStyle]="{'color': box.tile.characterStatClusterTiles.titleTextColor, 'background-color': box.tile.characterStatClusterTiles.titleBgColor}"
                        popover="{{box.tile.characterStatClusterTiles?.title}}" triggers="hover" container="body"
                        [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?13:15">
                      {{box.tile.characterStatClusterTiles?.title}}
                    </h5>-->

                    <div class="tile-body" *ngIf="!box.tile.characterStatClusterTiles?.isManual">
                      <span class="text-center-v"
                            [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)"
                            [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)"
                            [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                            [style.background-color]="box.tile.characterStatClusterTiles.bodyBgColor">
                        {{box.tile.characterStatClusterTiles?.title}}
                      </span>
                    </div>
                    <div class="tile-body" *ngIf="box.tile.characterStatClusterTiles?.isManual">
                      <span class="text-center-v"
                            [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize"
                            [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)"
                            [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                            [style.background-color]="box.tile.characterStatClusterTiles.bodyBgColor">
                        {{box.tile.characterStatClusterTiles?.title}}
                      </span>
                    </div>
                  </div>
                </div>
                <ng-container *ngIf="!box.tile.characterStatClusterTiles?.isManual">
                  <div class="tile-group tile-group-item_counts"
                       *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStatID"
                       [ngClass]="(box.tile.characterStatClusterTiles?.shape=='50')?'grid-rounded':(box.tile.characterStatClusterTiles?.shape=='100')?'grid-circle':''">
                    <div class="tile tile-type-note  tile-color-6" (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                         [style.background-color]="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command?((box.tile.characterStatClusterTiles?.showTitle && !box.tile?.characterStatClusterTiles?.imageUrl)?box.tile.characterStatClusterTiles.titleBgColor:box.tile.characterStatClusterTiles.bodyBgColor):box.tile.characterStatClusterTiles.bodyBgColor">

                      <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.characterStatClusterTiles?.titleTextColor, 'background-color': box.tile.characterStatClusterTiles.titleBgColor}"
                          *ngIf="(box.tile.characterStatClusterTiles?.showTitle && box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId!==STAT_TYPE.Command)||(box.tile.characterStatClusterTiles?.showTitle && box.tile?.characterStatClusterTiles?.imageUrl && box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command)"
                          popover="{{box.tile.characterStatClusterTiles?.title ? box.tile.characterStatClusterTiles?.title : box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.statName}}" triggers="hover" container="body"
                          [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.config.sizey==1?13:15">
                        {{box.tile.characterStatClusterTiles?.title ? box.tile.characterStatClusterTiles?.title : box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.statName}}
                      </h5>

                      <div class="tile-body text-overflow-hidden">
                        <div [ngClass]="(box.tile.characterStatClusterTiles?.shape=='50')?'grid-rounded':''" [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                             [style.background-color]="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.RichText ? '' : (box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command && box.tile.characterStatClusterTiles?.showTitle && !box.tile?.characterStatClusterTiles?.imageUrl)?box.tile.characterStatClusterTiles.titleBgColor:box.tile.characterStatClusterTiles.bodyBgColor">

                          <span class="text-center-v" [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                                [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)"
                                [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)"
                                *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Text">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.text}}
                          </span>

                          <span style="color:#000" *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.RichText"
                                [froalaView]="GetDescription(box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.richText)">
                          </span>

                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Number" [style.font-size.px]="box.config.sizex*box.config.sizey*5+30" class="text-center-v">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.number}}
                          </span>
                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.CurrentMax" [style.font-size.px]="box.config.sizex*box.config.sizey*2+11" class="text-center-v">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat.current}} / {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat.maximum}}
                          </span>

                          <div class="text-center-v bold-whitebg-textblack" *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Choice">
                            <p style="padding:0" *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect || (box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect && box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isChoiceNumeric)">
                              <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect && box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isChoiceNumeric">

                                <span class="no-comma"
                                      [style.font-size.px]="((box.config.sizey+box.config.sizex)*2) < 16 ? 18 : ((box.config.sizey+box.config.sizex)*2)"
                                      [style.line-height.px]="((box.config.sizey+box.config.sizex)*2+5)  < 18 ? 20 : ((box.config.sizey+box.config.sizex)*2+5)">
                                  {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue}} {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect ? box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.multiChoice?.length ? '/':'' :box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.choice?.length ? '/':''}}

                                </span>

                              </ng-container>

                              <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect">
                                <ng-container *ngFor="let choice of box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatChoices; let i = index">
                                  <ng-container *ngFor="let mChoice of box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.multiChoice?.split(';');let j = index">

                                    <span *ngIf="choice?.characterStatChoiceId===+mChoice && box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.multiChoice?.split(';')?.length>1"
                                          [style.font-size.px]="((box.config.sizey+box.config.sizex)*2) < 16 ? 18 : ((box.config.sizey+box.config.sizex)*2)"
                                          [style.line-height.px]="((box.config.sizey+box.config.sizex)*2+5)  < 18 ? 20 : ((box.config.sizey+box.config.sizex)*2+5)">
                                      {{choice.statChoiceValue}}

                                    </span>
                                    <span *ngIf="choice?.characterStatChoiceId===+mChoice && box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.multiChoice?.split(';')?.length<=1"
                                          [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)"
                                          [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                      {{choice.statChoiceValue}}

                                    </span>

                                  </ng-container>
                                </ng-container>
                              </ng-container>
                            </p>
                            <ng-container *ngIf="!box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect">
                              <p>
                                <ng-container *ngFor="let choice of box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatChoices; let i = index">
                                  <span class="no-comma" *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isChoiceNumeric && i==0" [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)"
                                        [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                    {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue}} {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect ? box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.multiChoice?.length ? '/':'' :box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.choice?.length ? '/':''}}

                                  </span>
                                </ng-container>
                                <ng-container *ngFor="let choice of box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatChoices; let i = index">
                                  <span *ngIf="choice?.characterStatChoiceId===+box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.choice" [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)"
                                        [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                    {{choice.statChoiceValue}}
                                  </span>
                                </ng-container>
                              </p>
                            </ng-container>
                            <!--<span *ngIf="choice?.characterStatChoiceId===+box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.choice" [style.font-size.px]="box.config.sizex*box.config.sizey*5+16" class="text-center-v">
                                {{choice.statChoiceValue}}
                            </span>-->

                          </div>

                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.ValueSubValue" [style.font-size.px]="box.config.sizex*box.config.sizey*2+11" class="text-center-v">

                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat.value}} ({{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat.subValue}})
                          </span>
                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.OnOff" [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.onOff ? 'ON' : 'OFF'}}
                          </span>
                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.YesNo" [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.yesNo ? 'YES' : 'NO'}}
                          </span>
                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Calculation" [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.calculationResult}}
                          </span>
                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command">

                            <img *ngIf="(box.tile.characterStatClusterTiles?.showTitle && box.tile?.characterStatClusterTiles?.imageUrl) || !box.tile.characterStatClusterTiles?.showTitle"
                                 [src]="box.tile?.characterStatClusterTiles?.imageUrl" [alt]="box.tile?.characterStatClusterTiles?.imageUrl"
                                 class="imgwidth" onerror="this.src='https://rpgsmithsa.blob.core.windows.net/stock-icons/d20.png';">

                            <span *ngIf="box.tile.characterStatClusterTiles?.showTitle && !box.tile?.characterStatClusterTiles?.imageUrl" class="text-center-v"
                                  [ngStyle]="{'color': box.tile.characterStatClusterTiles?.titleTextColor, 'background-color': box.tile.characterStatClusterTiles?.titleBgColor}"
                                  popover="{{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.statName}}" triggers="hover" container="body"
                                  [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey"
                                  [style.line-height.px]="box.config.sizey==1?13:30+box.config.sizex+box.config.sizey"
                                  [style.font-size.px]="box.config.sizey==1?13:15+box.config.sizex+box.config.sizey">
                              {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.statName}}
                            </span>

                          </span>
                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Combo" class="text-center-v" [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue}}
                            <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.comboText"> / {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.comboText}}</span>
                          </span>

                          <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Toggle">
                            <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.yesNo">
                              <span [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v noselect">{{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.isYes ? 'YES' : 'NO'}}</span>
                            </ng-container>
                            <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.onOff">
                              <span [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v noselect">{{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.isOn ? 'ON' : 'OFF'}}</span>
                            </ng-container>
                            <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.display">
                              <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.showCheckbox" [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v icon-Gen-Check noselect"></span>
                              <span *ngIf="!box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.showCheckbox" [style.font-size.px]="box.config.sizex*box.config.sizey*5+20" class="text-center-v icon-Gen-Uncheck noselect"></span>
                            </ng-container>


                            <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.isCustom">
                              <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterCustomToggles?.length">
                                <ng-container *ngFor="let toggleVal of box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterCustomToggles; let i = index">
                                  <ng-container *ngIf="toggleVal.initial">
                                    <ng-container *ngIf="toggleVal.toggleText">

                                      <!--<p class="noselect" [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                                         [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                        {{toggleVal.toggleText}}
                                      </p>-->

                                      <span class="noselect text-center-v" [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                                            [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                        {{toggleVal.toggleText}}
                                      </span>

                                    </ng-container>
                                    <ng-container *ngIf="toggleVal.image">
                                      <img class="imgwidth" [src]="toggleVal.image" onerror="this.src = 'https://rpgsmithsa.blob.core.windows.net/stock-defimg-rulesets/RS.png';" />
                                    </ng-container>
                                  </ng-container>

                                </ng-container>
                              </ng-container>
                            </ng-container>

                          </ng-container>

                          <div *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.LinkRecord">
                            <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue">
                              <img *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue && box.tile.characterStatClusterTiles?.displayLinkImage" class="imgwidth" [src]="GetLinkRecordImage(box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue,box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.linkType)" onerror="this.src = 'https://rpgsmithsa.blob.core.windows.net/stock-defimg-rulesets/RS.png';" />

                              <p [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                                 [style.font-size.px]="box.config.sizex > box.config.sizey ? (box.config.sizey*4 <= 14 ? 16 : box.config.sizey*4 ) :  (box.config.sizex*4 <= 14 ? 16 : box.config.sizex*4 ) "
                                 [style.line-height.px]="box.config.sizex > box.config.sizey ? (box.config.sizey*5 <= 18 ? 20 : box.config.sizey*5 ) :  (box.config.sizex*5 <= 18 ? 20 : box.config.sizex*5 ) "
                                 *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue && !box.tile.characterStatClusterTiles?.displayLinkImage">
                                {{GetLinkRecordText(box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue,box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.linkType)}}
                              </p>
                            </ng-container>

                            <ng-container *ngIf="!box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue">
                              <p [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                                 [style.font-size.px]="box.config.sizex > box.config.sizey ? (box.config.sizey*4 <= 14 ? 16 : box.config.sizey*4 ) :  (box.config.sizex*4 <= 14 ? 16 : box.config.sizex*4 ) ">
                                The targeted record has been removed
                              </p>
                            </ng-container>

                          </div>
                          <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Condition">
                            <span class="text-center-v" [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                                  [style.font-size.px]="((box.config.sizey*box.config.sizex)*2) < 21 ? 20 : ((box.config.sizey*box.config.sizex)*2)"
                                  [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                              {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.text}}
                            </span>
                          </ng-container>
                        </div>
                      </div>

                    </div>
                  </div>
                </ng-container>
                <ng-container *ngIf="box.tile.characterStatClusterTiles?.isManual">
                  <div class="tile-group tile-group-item_counts"
                       *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStatID"
                       [ngClass]="(box.tile.characterStatClusterTiles?.shape=='50')?'grid-rounded':(box.tile.characterStatClusterTiles?.shape=='100')?'grid-circle':''">
                    <div class="tile tile-type-note  tile-color-6" (click)="viewTile(box.tile, box.tile.tileTypeId, $event)"
                         [style.background-color]="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command?((box.tile.characterStatClusterTiles?.showTitle && !box.tile?.characterStatClusterTiles?.imageUrl)?box.tile.characterStatClusterTiles.titleBgColor:box.tile.characterStatClusterTiles.bodyBgColor):box.tile.characterStatClusterTiles.bodyBgColor">

                      <h5 class="tile-title wraptext" [ngStyle]="{'color': box.tile.characterStatClusterTiles?.titleTextColor, 'background-color': box.tile.characterStatClusterTiles.titleBgColor}"
                          *ngIf="(box.tile.characterStatClusterTiles?.showTitle && box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId!==STAT_TYPE.Command)||(box.tile.characterStatClusterTiles?.showTitle && box.tile?.characterStatClusterTiles?.imageUrl && box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command)"
                          popover="{{box.tile.characterStatClusterTiles?.title ? box.tile.characterStatClusterTiles?.title : box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.statName}}" triggers="hover" container="body"
                          [style.height.px]="box.config.sizey==1?20:40" [style.line-height.px]="box.config.sizey==1?13:30" [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSizeTitle">
                        {{box.tile.characterStatClusterTiles?.title ? box.tile.characterStatClusterTiles?.title : box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.statName}}
                      </h5>

                      <div class="tile-body text-overflow-hidden">
                        <div [ngClass]="(box.tile.characterStatClusterTiles?.shape=='50')?'grid-rounded':''" [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                             [style.background-color]="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.RichText ? '' : (box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command && box.tile.characterStatClusterTiles?.showTitle && !box.tile?.characterStatClusterTiles?.imageUrl)?box.tile.characterStatClusterTiles.titleBgColor:box.tile.characterStatClusterTiles.bodyBgColor">

                          <span class="text-center-v" [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                                [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize"
                                [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)"
                                *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Text">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.text}}
                          </span>

                          <span style="color:#000" *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.RichText"
                                [froalaView]="GetDescription(box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.richText)">
                          </span>

                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Number" [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize" class="text-center-v">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.number}}
                          </span>
                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.CurrentMax" [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize" class="text-center-v">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat.current}} / {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat.maximum}}
                          </span>

                          <div class="text-center-v bold-whitebg-textblack" *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Choice">
                            <p style="padding:0" *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect || (box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect && box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isChoiceNumeric)">
                              <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect && box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isChoiceNumeric">

                                <span class="no-comma"
                                      [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize"
                                      [style.line-height.px]="((box.config.sizey+box.config.sizex)*2+5)  < 18 ? 20 : ((box.config.sizey+box.config.sizex)*2+5)">
                                  {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue}} {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect ? box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.multiChoice?.length ? '/':'' :box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.choice?.length ? '/':''}}

                                </span>

                              </ng-container>

                              <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect">
                                <ng-container *ngFor="let choice of box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatChoices; let i = index">
                                  <ng-container *ngFor="let mChoice of box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.multiChoice?.split(';');let j = index">

                                    <span *ngIf="choice?.characterStatChoiceId===+mChoice && box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.multiChoice?.split(';')?.length>1"
                                          [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize"
                                          [style.line-height.px]="((box.config.sizey+box.config.sizex)*2+5)  < 18 ? 20 : ((box.config.sizey+box.config.sizex)*2+5)">
                                      {{choice.statChoiceValue}}

                                    </span>
                                    <span *ngIf="choice?.characterStatChoiceId===+mChoice && box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.multiChoice?.split(';')?.length<=1"
                                          [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize"
                                          [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                      {{choice.statChoiceValue}}

                                    </span>

                                  </ng-container>
                                </ng-container>
                              </ng-container>
                            </p>
                            <ng-container *ngIf="!box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect">
                              <p>
                                <ng-container *ngFor="let choice of box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatChoices; let i = index">
                                  <span class="no-comma" *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isChoiceNumeric && i==0" [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize"
                                        [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                    {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue}} {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.isMultiSelect ? box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.multiChoice?.length ? '/':'' :box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.choice?.length ? '/':''}}

                                  </span>
                                </ng-container>
                                <ng-container *ngFor="let choice of box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatChoices; let i = index">
                                  <span *ngIf="choice?.characterStatChoiceId===+box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.choice" [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize"
                                        [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                    {{choice.statChoiceValue}}
                                  </span>
                                </ng-container>
                              </p>
                            </ng-container>
                          </div>

                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.ValueSubValue" [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize" class="text-center-v">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat.value}} ({{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat.subValue}})
                          </span>
                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.OnOff" [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize" class="text-center-v">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.onOff ? 'ON' : 'OFF'}}
                          </span>
                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.YesNo" [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize" class="text-center-v">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.yesNo ? 'YES' : 'NO'}}
                          </span>
                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Calculation" [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize" class="text-center-v">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.calculationResult}}
                          </span>
                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Command">

                            <img *ngIf="(box.tile.characterStatClusterTiles?.showTitle && box.tile?.characterStatClusterTiles?.imageUrl) || !box.tile.characterStatClusterTiles?.showTitle"
                                 [src]="box.tile?.characterStatClusterTiles?.imageUrl" [alt]="box.tile?.characterStatClusterTiles?.imageUrl"
                                 class="imgwidth" onerror="this.src='https://rpgsmithsa.blob.core.windows.net/stock-icons/d20.png';">

                            <span *ngIf="box.tile.characterStatClusterTiles?.showTitle && !box.tile?.characterStatClusterTiles?.imageUrl" class="text-center-v"
                                  [ngStyle]="{'color': box.tile.characterStatClusterTiles?.titleTextColor, 'background-color': box.tile.characterStatClusterTiles?.titleBgColor}"
                                  popover="{{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.statName}}" triggers="hover" container="body"
                                  [style.height.px]="box.config.sizey==1?20:40+box.config.sizex+box.config.sizey"
                                  [style.line-height.px]="box.config.sizey==1?13:30+box.config.sizex+box.config.sizey"
                                  [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize">
                              {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.statName}}
                            </span>

                          </span>
                          <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Combo" class="text-center-v" [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                            {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue}}
                            <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.comboText"> / {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.comboText}}</span>
                          </span>

                          <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Toggle">
                            <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.yesNo">
                              <span [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize" class="text-center-v noselect">{{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.isYes ? 'YES' : 'NO'}}</span>
                            </ng-container>
                            <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.onOff">
                              <span [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize" class="text-center-v noselect">{{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.isOn ? 'ON' : 'OFF'}}</span>
                            </ng-container>
                            <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.display">
                              <span *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.showCheckbox" [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize" class="text-center-v icon-Gen-Check noselect"></span>
                              <span *ngIf="!box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.showCheckbox" [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize" class="text-center-v icon-Gen-Uncheck noselect"></span>
                            </ng-container>

                            <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.isCustom">
                              <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterCustomToggles?.length">
                                <ng-container *ngFor="let toggleVal of box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterCustomToggles; let i = index">
                                  <ng-container *ngIf="toggleVal.initial">
                                    <ng-container *ngIf="toggleVal.toggleText">
                                      <span class="noselect text-center-v" [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                                            [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize" [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                                        {{toggleVal.toggleText}}
                                      </span>
                                    </ng-container>
                                    <ng-container *ngIf="toggleVal.image">
                                      <img class="imgwidth" [src]="toggleVal.image" onerror="this.src = 'https://rpgsmithsa.blob.core.windows.net/stock-defimg-rulesets/RS.png';" />
                                    </ng-container>
                                  </ng-container>
                                </ng-container>
                              </ng-container>
                            </ng-container>

                          </ng-container>

                          <div *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.LinkRecord">
                            <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue">
                              <img *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue && box.tile.characterStatClusterTiles?.displayLinkImage" class="imgwidth" [src]="GetLinkRecordImage(box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue,box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.linkType)" onerror="this.src = 'https://rpgsmithsa.blob.core.windows.net/stock-defimg-rulesets/RS.png';" />

                              <p [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                                 [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize"
                                 [style.line-height.px]="box.config.sizex > box.config.sizey ? (box.config.sizey*5 <= 18 ? 20 : box.config.sizey*5 ) :  (box.config.sizex*5 <= 18 ? 20 : box.config.sizex*5 ) "
                                 *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue && !box.tile.characterStatClusterTiles?.displayLinkImage">
                                {{GetLinkRecordText(box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue,box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.linkType)}}
                              </p>
                            </ng-container>

                            <ng-container *ngIf="!box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.defaultValue">
                              <p [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                                 [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize">
                                The targeted record has been removed
                              </p>
                            </ng-container>

                          </div>
                          <ng-container *ngIf="box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.characterStat?.characterStatTypeId==STAT_TYPE.Condition">
                            <span class="text-center-v" [style.color]="box.tile.characterStatClusterTiles.bodyTextColor"
                                  [style.font-size.px]="box.tile.characterStatClusterTiles?.fontSize"
                                  [style.line-height.px]="((box.config.sizey*box.config.sizex)*2+5)  < 24 ? 25 : ((box.config.sizey*box.config.sizex)*2+5)">
                              {{box.tile.characterStatClusterTiles?.displayCharactersCharacterStat?.text}}
                            </span>
                          </ng-container>
                        </div>
                      </div>

                    </div>
                  </div>
                </ng-container>
              </ng-container>

            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="" style="display:none;">
      <ul class="page-toolbar-actions">
        <li class="popup-new-tile-trigger">
          <button type="button" (click)="openTile()" class="btn icon icon-plus btn-primary"></button>
        </li>
      </ul>
    </div>
  </div>

</div>

<app-loader [isLoading]="isLoading
            || isInventoryLoading
            || isRulesetViewInventoryLoading
            || isAlliesLoading
            || isAbilitiesLoading
            || isRulesetViewAbilityLoading
            || isSpellsLoading
            || isRulesetSpellsLoading
            || isLootLoading" [isCharacterLoading]="true"></app-loader>

<!--<h1>
  1 - {{isLoading}}
  2 - {{isInventoryLoading}}
  3 - {{isRulesetViewInventoryLoading}}
  4 - {{isAlliesLoading}}
  5 - {{isAbilitiesLoading}}
  6 - {{isRulesetViewAbilityLoading}}
  7 - {{isSpellsLoading}}
  8 - {{isRulesetSpellsLoading}}
  9 - {{isLootLoading}}
</h1>-->
