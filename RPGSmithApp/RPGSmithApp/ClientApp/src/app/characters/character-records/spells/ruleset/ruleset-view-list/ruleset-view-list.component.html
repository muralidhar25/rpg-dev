<div class="page-inventory">
    <!-- Toolbar -->
    <div class="page-toolbar">
        <div class="container">
            <div class="page-toolbar-wrapper">
                <div class="page-toolbar-title">
                    <a (click)="back()" class="icon icon-back">
                        <h1 class="d-none d-md-inline-block"> Back</h1>
                    </a>
                    <h1 class="d-md-none"> Spells</h1>
                </div>
                <!--<div class="page-toolbar-wrapper-toggle-trigger">
                    <button type="button" class="btn icon icon-with-text btn-accent btn-block" (click)="showActionButtons(showActions)"
                            [ngClass]="{'icon-arrow-up' : showActions,  'icon-arrow-down' : !showActions}">
                        {{actionText}}
                    </button>
                </div>-->
                <div class="page-toolbar-wrapper initial show recordes-menu1">
                    <ul class="page-toolbar-links">
                        <!--<li *ngIf="rulesetModel">
                            <a [routerLink]="['/ruleset/dashboard/', ruleSetId]" class="btn btn-link-primary nav-redirection">Layouts</a>
                        </li>-->
                        <li *ngIf="rulesetModel?.isItemEnabled" class="hidden-tab">
                            <a [routerLink]="charNav?.items" class="btn btn-link-primary nav-redirection icon-Gen-Items"> <span>Inventory</span></a>
                        </li>
                        <li *ngIf="rulesetModel?.isSpellEnabled" class="hidden-tab">
                            <a [routerLink]="charNav?.spells" class="btn btn-link-primary nav-redirection selected icon-Rec-Magical"> <span>Spells</span></a>
                        </li>
                        <li *ngIf="rulesetModel?.isAbilityEnabled" class="hidden-tab">
                            <a [routerLink]="charNav?.abilities" class="btn btn-link-primary nav-redirection icon-Gen-Ability"> <span>Abilities</span></a>
                        </li>
                        <li *ngIf="rulesetModel" class="hidden-tab">
                            <a [routerLink]="['/character/character-stats/', character.characterId]" class="btn btn-link-primary nav-redirection icon-Gen-CharStat"> <span>Character Stats</span></a>
                        </li>
                        <li class="visible-tab mt-0">
                          <div class="dropdown dropdown-buttons" [ngClass]="{'show': isDropdownOpen}">
                            <button type="button" data-toggle="dropdown" aria-expanded="false" class="btn btn-primary dropdown-toggle is-show">Records</button>
                            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="newItemTrigger" *ngIf="isDropdownOpen">
                              <ul class="dropdown-menu-list">
                                <li *ngIf="rulesetModel?.isItemEnabled" class="dropdown-menu-item">
                                  <a [routerLink]="charNav?.items" class="btn btn-link-primary nav-redirection icon-Gen-Items"> <span>Inventory</span></a>
                                </li>
                                <li *ngIf="rulesetModel?.isSpellEnabled" class="dropdown-menu-item">
                                  <a [routerLink]="charNav?.spells" class="btn btn-link-primary nav-redirection selected icon-Rec-Magical"> <span>Spells</span></a>
                                </li>
                                <li *ngIf="rulesetModel?.isAbilityEnabled" class="dropdown-menu-item">
                                  <a [routerLink]="charNav?.abilities" class="btn btn-link-primary nav-redirection icon-Gen-Ability"> <span>Abilities</span></a>
                                </li>
                                <li *ngIf="rulesetModel" class="dropdown-menu-item">
                                  <a [routerLink]="['/character/character-stats/', character.characterId]" class="btn btn-link-primary nav-redirection icon-Gen-CharStat"> <span>Character Stats</span></a>
                                </li>
                              </ul>
                            </div>
                          </div>
                        </li>
                        <!--<li>
                            <div class="dropdown dropdown-buttons">
                                <button type="button" (click)="createSpell()" data-toggle="dropdown" aria-expanded="false" class="btn icon icon-with-text icon-plus btn-primary btn-block"> <span>Create Spell</span></button>
                            </div>
                        </li>-->
                    </ul>
                </div>
                <ul class="page-toolbar-actions">
                    <li class="view-switch">
                        <div class="btn-group" role="group">
                            <button type="button" id="gridViewTrigger" class="btn icon icon-grid btn-primary" [ngClass]="{'selected':!isListView}" (click)="showListView(false)"></button>
                            <button type="button" id="listViewTrigger" class="btn icon icon-list btn-primary" [ngClass]="{'selected':isListView}" (click)="showListView(true)"></button>
                        </div>
                    </li>
                    <!--<li>
                        <div class="dropdown dropdown-buttons">
                            <button type="button" (click)="createSpell()" data-toggle="dropdown" aria-expanded="false" class="btn icon icon-with-text icon-plus btn-primary btn-block"> Create Spell</button>
                        </div>
                    </li>-->
                    <li>
                        <button type="button" (click)="openDiceRollModal()" class="btn icon icon-with-text icon-dice icon-rsi btn-primary"><span class="text-hide-tab">Dice</span></button>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <!-- End of toolbar -->
    <!-- Inventory cards -->
    <div class="cards cards-inventory form-row" *ngIf="!isLoading" infiniteScroll (scrolled)="onScroll()" [infiniteScrollDistance]="1"
         [infiniteScrollThrottle]="300" [scrollWindow]="true">
        <div class="container">
            <div class="card-list justify-content-center justify-content-lg-start" [ngClass]="{'view-list':isListView}">
                <p class="text-center py-5 w-100 d-block" *ngIf="noRecordFound">No Spells have been added to this ruleset.</p>
                <div class="card-wrapper" *ngFor="let spell of spellsList">
                    <div class="card">
                        <div class="card-image" [ngClass]="{'thumbnail':!isListView, 'thumbnail-list':isListView}">

                            <img class="card-img-top portrait" [src]="spell.imageUrl" [alt]="spell.imageUrl"
                                 onerror="this.src='https://rpgsmithsa.blob.core.windows.net/stock-defimg-spells/Fire.jpg';"
                                 [routerLink]="['/character/ruleset/spell-details/', spell.spellId]">

                            <div class="card-actions show" *ngIf="spell.showIcon && !isListView">
                                <button type="button" (click)="editSpell(spell)" tooltip="Edit" class="btn icon icon-pencil btn-simple-primary"></button>
                                <button type="button" (click)="duplicateSpell(spell)" tooltip="Duplicate" class="btn icon icon-copy icon-rsi btn-simple-primary"></button>
                                <button type="button" (click)="deleteSpell(spell)" tooltip="Delete" class="btn icon icon-trash btn-simple-primary"></button>
                                <button type="button" (click)="manageIcon(false)" tooltip="Close" class="btn icon icon-cross btn-simple-primary"></button>
                            </div>
                        </div>
                        <div class="card-body" [routerLink]="['/character/ruleset/spell-details/', spell.spellId]">
                            <h4 class="card-title" popover="{{spell.name}}" triggers="hover">{{spell.name}}</h4>
                            <ul class="item-properties">
                                <li class="item-property item-property-text class" *ngIf="isListView && spell.class">{{spell.class}}</li>
                                <li class="item-property item-property-text school" *ngIf="isListView && spell.school">{{spell.school}}</li>
                                <li class="item-property item-property-text levels" *ngIf="spell.levels">{{spell.levels}}</li>
                                <li class="item-property item-property-text castingTime" *ngIf="isListView && spell.castingTime">{{spell.castingTime}}</li>
                            </ul>
                            <ul class="item-properties">
                                <li *ngIf="spell.isSomaticComponent" class="item-property item-property-icon icon-ico icon-Rec-Somantic" title="Somatic Component" data-toggle="tooltip"></li>
                                <li *ngIf="spell.isVerbalComponent" class="item-property item-property-icon icon-ico icon-Rec-Verbal" title="Verbal Component" data-toggle="tooltip"></li>
                                <li *ngIf="spell.isMaterialComponent" class="item-property item-property-icon icon-ico icon-Rec-Material" title="Material Component" data-toggle="tooltip"></li>
                            </ul>
                            <!-- <div class="item-stats" [froalaView]="spell?.description"></div> -->
                        </div>
                        <div class="card-actions-trigger" [hidden]="spell.showIcon">
                            <button type="button" (click)="manageIcon(spell.spellId)" tooltip="Manage" class="btn icon icon-more btn-simple-primary"></button>
                        </div>
                        <div class="card-actions show" *ngIf="spell.showIcon && isListView">
                            <button type="button" (click)="editSpell(spell)" tooltip="Edit" class="btn icon icon-pencil btn-simple-primary"></button>
                            <button type="button" (click)="duplicateSpell(spell)" tooltip="Duplicate" class="btn icon icon-copy icon-rsi btn-simple-primary"></button>
                            <button type="button" (click)="deleteSpell(spell)" tooltip="Delete" class="btn icon icon-trash btn-simple-primary"></button>
                            <button type="button" (click)="manageIcon(false)" tooltip="Close" class="btn icon icon-cross btn-simple-primary"></button>
                        </div>
                        <div class="item-actions d-block">
                            <button type="button" class="btn btn-accent icon-Rec-Add text-icon-center" (click)="AddSpell(spell)">Add Spell</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End of inventory cards -->
</div>

<app-loader [isLoading]="isLoading"></app-loader>
<div class="spinner" *ngIf="scrollLoading">
    <img src="../../../../assets/images/PageLoader.gif" />
</div>
<div class="notclickscreen" *ngIf="IsAddingRecord"></div>
