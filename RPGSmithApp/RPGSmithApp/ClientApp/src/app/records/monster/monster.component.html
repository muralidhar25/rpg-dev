<div class="page-inventory">
    <!-- Toolbar -->
    <div class="page-toolbar">
        <div class="container">
            <div class="page-toolbar-wrapper">
                <div class="page-toolbar-title">
                    <a [routerLink]="backURL" class="icon icon-back">
                        <h1 class="d-none d-md-inline-block"> Back</h1>
                    </a>
                    <h1 class="d-md-none">Monsters</h1>
                </div>
                <!--<div class="page-toolbar-wrapper-toggle-trigger">
                    <button type="button" class="btn icon icon-with-text btn-accent btn-block" (click)="showActionButtons(showActions)"
                            [ngClass]="{'icon-arrow-up' : showActions,  'icon-arrow-down' : !showActions}">
                        {{actionText}}
                    </button>
                </div>-->
                <div class="page-toolbar-wrapper initial show recordes-menu">
                    <!-- Toolbar links -->
                  <ul class="page-toolbar-links" *ngIf="!isLoading">
                    <li *ngIf="rulesetModel" class="hidden-tab">
                      <a *ngIf="!IsGm"  [routerLink]="['/ruleset/dashboard/', ruleSetId]" class="btn btn-link-primary nav-redirection">Layouts</a>
                      <a *ngIf="IsGm"  [routerLink]="['/ruleset/campaign-dashboard/', ruleSetId]" class="btn btn-link-primary nav-redirection">Layouts</a>
                    </li>
                    <li *ngIf="rulesetModel?.isItemEnabled" class="hidden-tab">
                      <a [routerLink]="['/ruleset/item-master/', ruleSetId]" class="btn btn-link-primary nav-redirection icon-Gen-Items"> <span>Item Templates</span></a>
                    </li>
                    <li *ngIf="rulesetModel?.isSpellEnabled" class="hidden-tab">
                      <a [routerLink]="['/ruleset/spell/', ruleSetId]" class="btn btn-link-primary nav-redirection icon-Rec-Magical"> <span>Spells</span></a>
                    </li>
                    <li *ngIf="IsGm" class="hidden-tab">
                      <a [routerLink]="['/ruleset/monster/', ruleSetId]" class="btn btn-link-primary nav-redirection selected icon-Monster"> <span>Monster</span></a>
                    </li>
                    <!--<li *ngIf="rulesetModel" class="hidden-tab">
                      <a [routerLink]="['/ruleset/character-stats/', ruleSetId]" class="btn btn-link-primary nav-redirection icon-Gen-CharStat"> <span>Character Stats</span></a>
                    </li>-->
                    <li class="visible-tab">
                      <div class="dropdown dropdown-buttons" [ngClass]="{'show': isDropdownOpen}">
                        <button type="button" data-toggle="dropdown" aria-expanded="false" class="btn btn-primary dropdown-toggle is-show">Records</button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="newItemTrigger" *ngIf="isDropdownOpen">
                          <ul class="dropdown-menu-list" *ngIf="!isLoading">
                            <li *ngIf="rulesetModel?.isItemEnabled" class="dropdown-menu-item">
                              <a *ngIf="!IsGm" [routerLink]="['/ruleset/dashboard/', ruleSetId]" class="btn btn-link-primary nav-redirection">Layouts</a>
                              <a *ngIf="IsGm" [routerLink]="['/ruleset/campaign-dashboard/', ruleSetId]" class="btn btn-link-primary nav-redirection">Layouts</a>
                            </li>
                            <li *ngIf="rulesetModel?.isItemEnabled" class="dropdown-menu-item">
                              <a [routerLink]="['/ruleset/item-master/', ruleSetId]" class="btn btn-link-primary nav-redirection icon-Gen-Items"> Item Templates</a>
                            </li>
                            <li *ngIf="rulesetModel?.isSpellEnabled" class="dropdown-menu-item">
                              <a [routerLink]="['/ruleset/spell/', ruleSetId]" class="btn btn-link-primary nav-redirection icon-Rec-Magical"> Spells</a>
                            </li>
                            <li *ngIf="IsGm" class="dropdown-menu-item">
                              <a [routerLink]="['/ruleset/monster/', ruleSetId]" class="btn btn-link-primary nav-redirection selected icon-Monster"> <span>Monster</span></a>
                            </li>
                            <!--<li *ngIf="rulesetModel" class="dropdown-menu-item">
                              <a [routerLink]="['/ruleset/character-stats/', ruleSetId]" class="btn btn-link-primary nav-redirection icon-Gen-CharStat"> Character Stats</a>
                            </li>-->
                          </ul>
                        </div>
                      </div>
                    </li>
                    <li>
                      <div class="dropdown dropdown-buttons" [ngClass]="{'show': isDropdownOpen}">
                        <button type="button" data-toggle="dropdown" aria-expanded="false" class="btn icon icon-with-text icon-plus btn-primary dropdown-toggle is-show">
                          <span class="text-hide-tab  is-show">New Monster</span>
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="newItemTrigger" *ngIf="isDropdownOpen">
                          <ul class="dropdown-menu-list">
                            <li class="dropdown-menu-item">
                              <button type="button" (click)="addMonster()" class="btn btn-accent icon-Gen-Edit"> Add Monster</button>
                            </li>
                            <li class="dropdown-menu-item">
                              <button type="button" (click)="createMonster()" class="btn btn-accent icon-Gen-Edit"> Create Monster</button>
                            </li>
                          </ul>
                        </div>
                      </div>
                      <!--<div class="dropdown dropdown-buttons">
    <button type="button" (click)="createMonster()" data-toggle="dropdown" aria-expanded="false" class="btn icon icon-with-text icon-plus btn-primary btn-block"> <span>Create Monster</span></button>
  </div>-->
                    </li>                  
                  </ul>
                    <!-- End of toolbar links -->
                </div>
                <ul class="page-toolbar-actions">
                  <li class="view-switch">
                    <div class="btn-group" role="group">

                      <div class="dropdown">
                        <button class="btn dropdown-toggle filter-toggle-btn" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" popover="{{monstersFilter.name}}" triggers="hover click">
                          &nbsp;{{monstersFilter.viewableCount}}
                          <span *ngIf="monstersFilter.type == 1"><i>A</i></span>
                          <span *ngIf="monstersFilter.type == 2"><i>CR</i></span>
                          <span *ngIf="monstersFilter.type == 3"><i class="icon icon-Health"> </i></span>
                        </button>
                          <div class="dropdown-menu filter-toggle-btn-menu" aria-labelledby="dropdownMenuButton">
                            <button type="button" id="listViewTrigger" class="btn" [ngClass]="Alphabetical ? 'selected' :''" (click)="applyFilters(1,false,true)"><i>A</i>Alphabetical <span>{{alphabetCount}}</span></button>
                            <button type="button" id="challageViewTrigger" class="btn" [ngClass]="ChallangeRating ? 'selected' :''" (click)="applyFilters(2,false,true)"><i>CR</i>Challenge Rating <span>{{ChallangeRatingCount}}</span></button>
                            <button type="button" id="HealthViewTrigger" class="btn icon icon-Health" [ngClass]="Health ? 'selected' :''" (click)="applyFilters(3,false,true)">Health <span>{{HealthCount}}</span></button>
                          </div>
                        </div>

                        <!--<button type="button" id="gridViewTrigger" class="btn icon icon-grid btn-primary" [ngClass]="{'selected':!isListView}" (click)="showListView(false)"></button>
         <button type="button" id="listViewTrigger" class="btn icon icon-list btn-primary" [ngClass]="{'selected':isListView}" (click)="showListView(true)"></button>-->
                        <div class="dropdown">
                          <button class="btn dropdown-toggle filter-toggle-btn-light" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i [ngClass]="isDenseView ? 'icon-Rec-Dense': '' "></i>
                            <i [ngClass]="!isListView && !isDenseView ? 'icon icon-grid' :''"></i>
                            <i [ngClass]="isListView && !isDenseView ? 'icon icon-list' :''"></i>
                          </button>
                          <div class="dropdown-menu filter-toggle-btn-menu" aria-labelledby="dropdownMenuButton">
                            <button type="button" id="gridViewTrigger" class="btn icon icon-list" [ngClass]="isListView && !isDenseView ? 'selected' :''" (click)="showListView(true)"> List</button>
                            <button type="button" id="listViewTrigger" class="btn icon icon-grid" [ngClass]="!isListView && !isDenseView ? 'selected' :''" (click)="showListView(false)"> Grid </button>
                            <button type="button" id="denseViewTrigger" class="btn icon icon-Rec-Dense" [ngClass]="isDenseView ? 'selected': '' " (click)="showDenseview(true)"> Dense</button>
                          </div>
                        </div>
                      </div>
                  </li>
                  <li>
                    <div class="dropdown dropdown-buttons" [ngClass]="{'show': isDropdownOpen}">
                      <button type="button" data-toggle="dropdown" aria-expanded="false" class="btn icon icon-with-text icon-plus btn-primary dropdown-toggle is-show">
                        <span class="text-hide-tab  is-show">New Monster</span>
                      </button>
                      <div class="dropdown-menu dropdown-menu-right" aria-labelledby="newItemTrigger" *ngIf="isDropdownOpen">
                        <ul class="dropdown-menu-list">
                          <li class="dropdown-menu-item">
                            <button type="button" (click)="addMonster()" class="btn btn-accent icon-Gen-Edit"> Add Monster</button>
                          </li>
                          <li class="dropdown-menu-item">
                            <button type="button" (click)="createMonster()" class="btn btn-accent icon-Gen-Edit"> Create Monster</button>
                          </li>
                        </ul>
                      </div>
                    </div>
                    <!--<div class="dropdown dropdown-buttons">
    <button type="button" (click)="createMonster()" data-toggle="dropdown" aria-expanded="false" class="btn icon icon-with-text icon-plus btn-primary btn-block"><span class="text-hide-tab  is-show">Create Monster</span></button>
  </div>-->
                  </li>
                  <li>
                    <button type="button" *ngIf="IsGm && !isLoading" (click)="openDiceRollModal()" class="btn icon icon-with-text icon-dice icon-rsi btn-primary">Dice</button>
                  </li>
                </ul>
            </div>
        </div>
    </div>
    <!-- End of toolbar -->
    <!-- Inventory cards -->
    <div class="cards cards-inventory form-row" *ngIf="!isLoading" infiniteScroll (scrolled)="onScroll()" [infiniteScrollDistance]="1"
         [infiniteScrollThrottle]="300" [scrollWindow]="true">
        <div class="container">
            <div class="card-list justify-content-center justify-content-lg-start" [ngClass]="{'view-list':isListView, 'dense-list': isDenseView}">
              <p class="text-center py-5 w-100 d-block" *ngIf="noRecordFound">No Monster have been added to this ruleset. Click "+New Monster" to add some.</p>
                <ng-container *ngFor="let monster of monsterList">
                    <div class="card-wrapper" (mousedown)="editRecord(monster)" (mouseup)="clickAndHold(monster)" (mouseleave)="clickAndHold(monster)">
                      <div class="card" [ngClass]="{'card-equip':monster?.addToCombatTracker}">
                        <div class="card-image" [ngClass]="{'thumbnail':!isListView, 'thumbnail-list':isListView}">

                          <img class="card-img-top portrait" [src]="monster?.imageUrl" [alt]="monster?.imageUrl"
                               onerror="this.src='https://rpgsmithsa.blob.core.windows.net/stock-defimg-items/Quiver.jpg';" [routerLink]="['/ruleset/monster-details', monster.monsterId]">

                          <div class="card-actions show" *ngIf="monster?.showIcon && !isListView">
                            <button type="button" (click)="editMonster(monster)" title="Edit" data-toggle="tooltip" data-action="edit" class="btn icon icon-pencil btn-simple-primary"></button>
                            <button type="button" (click)="duplicateMonster(monster)" title="Duplicate" data-toggle="tooltip" data-action="duplicate" class="btn icon icon-copy icon-rsi btn-simple-primary"></button>
                            <button type="button" (click)="deleteMonster(monster)" title="Delete" data-toggle="tooltip" data-action="delete" class="btn icon icon-trash btn-simple-primary"></button>
                            <button type="button" (click)="manageIcon(false)" title="Close" data-toggle="tooltip" data-action="close" class="btn icon icon-cross btn-simple-primary"></button>
                          </div>
                        </div>
                        <div class="card-body" [routerLink]="['/ruleset/monster-details', monster.monsterId]">
                          <h4 class="card-title" popover="{{monster?.name}}" triggers="hover">{{monster?.name}}</h4>
                          <ul class="item-properties">
                            <li class="item-property item-property-text weight" *ngIf="monster?.challangeRating">CR: {{monster?.challangeRating}}</li>
                            <li class="item-property item-property-text weight" *ngIf="monster?.armorClass">AC: {{monster?.armorClass}}</li>
                            <li class="item-property item-property-text weight" *ngIf="monster?.health">H: {{monster?.healthCurrent}} /  {{monster?.healthMax}}</li>
                          </ul>
                          <ul class="item-properties " *ngIf="isListView || isDenseView">
                            <li *ngIf="monster?.addToCombatTracker" title="Combat" data-toggle="tooltip">
                              <i class="item-property item-property-icon icon icon-Combat icon-ico"></i>
                            </li>                           
                          </ul>
                          <ul class="item-properties" *ngIf="!isListView">
                            <li *ngIf="monster?.addToCombatTracker" title="Combat" data-toggle="tooltip">
                              <i class="item-property item-property-icon icon icon-Combat icon-ico"></i>
                            </li>                          
                          </ul>
                          <div class="item-stats pl-0" *ngIf="monster?.description" [froalaView]="monster?.monsterTemplate?.description"></div>
                        </div>
                        <div class="card-actions-trigger" *ngIf="!monster?.showIcon">
                          <button type="button" (click)="manageIcon(monster?.monsterId)" title="Manage" data-toggle="tooltip" class="btn icon icon-more btn-simple-primary"></button>
                        </div>
                        <div class="card-actions show" *ngIf="monster?.showIcon && isListView">
                          <button type="button" (click)="editMonster(monster)" title="Edit" data-toggle="tooltip" data-action="edit" class="btn icon icon-pencil btn-simple-primary"></button>
                          <button type="button" (click)="duplicateMonster(monster)" title="Duplicate" data-toggle="tooltip" data-action="duplicate" class="btn icon icon-copy icon-rsi btn-simple-primary"></button>
                          <button type="button" (click)="deleteMonster(monster)" title="Delete" data-toggle="tooltip" data-action="delete" class="btn icon icon-trash btn-simple-primary"></button>
                          <button type="button" (click)="manageIcon(false)" title="Close" data-toggle="tooltip" data-action="close" class="btn icon icon-cross btn-simple-primary"></button>
                        </div>
                        <div class="item-actions mobile-buttons">
                          <button type="button" (click)="enableCombatTracker(monster)" class="btn btn-accent" [ngClass]="{'icon-Rec-Add':!monster?.addToCombatTracker,'icon-Rec-Remove':monster?.addToCombatTracker}"> COMBAT</button>
                          <button type="button" (click)="dropMonsterItems(monster)" class="btn btn-accent icon-Rec-Drop"> DROP</button>
                          <button *ngIf="monster?.monsterTemplate?.command"  type="button" (click)="useMonster(monster)" class="btn btn-accent icon-Tile-Execute"> ATTACK</button>
                        </div>
                        <div class="item-actions">
                          <button type="button" (click)="enableCombatTracker(monster)" class="btn btn-accent" [ngClass]="{'icon-Rec-Add':!monster?.addToCombatTracker,'icon-Rec-Remove':monster?.addToCombatTracker}"> COMBAT</button>
                          <button type="button" (click)="dropMonsterItems(monster)" class="btn btn-accent icon-Rec-Drop"> DROP</button>
                          <button  *ngIf="monster?.monsterTemplate?.command" type="button" (click)="useMonster(monster)" class="btn btn-accent icon-Tile-Execute"> ATTACK</button>
                        </div>
                        </div>
                      </div>
                </ng-container>
            </div>
        </div>
    </div>
    <!-- End of inventory cards -->

    <app-loader [isLoading]="isLoading"></app-loader>
    <div class="spinner" *ngIf="scrollLoading">
        <img src="../../../../assets/images/PageLoader.gif" />
    </div>

</div>

