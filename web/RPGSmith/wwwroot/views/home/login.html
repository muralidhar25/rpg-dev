<div class="container-fluid login_page">
    <div class="text-center rpgs-login" ng-hide="registersuccess">
        <div class="logo"></div>
        <div class="login-form-1" >
            <form id="login-form" class="text-left">
                <div class="login-form-main-message"></div>
                <div class="main-login-form">
                    <div class="login-group state-{{mode}}">
                        <div class="form-group register" ng-class="{'open': mode==2}">
                            <label for="lg_username" class="sr-only">Username</label>
                            <input type="text" class="form-control" name="lg_username" placeholder="username" ng-model="data.username">
                        </div>
                        <div class="form-group register" ng-class="{'open': mode==2 || mode==1 || mode==3}">
                            <label for="lg_email" class="sr-only">Emailll</label>
                            <input type="email" class="form-control" name="lg_email" placeholder="emailll address" ng-model="data.email">
                        </div>
                        <div class="form-group register" ng-class="{'open': mode != 3}">
                            <label for="lg_password1" class="sr-only">Password</label>
                            <input type="password" class="form-control" name="lg_password1" placeholder="password" ng-model="data.password" ng-keypress="passwordKeyPress($event)">
                        </div>
                        <div class="form-group register" ng-class="{'open': mode == 2}">
                            <label for="lg_password2" class="sr-only">Confirm Password</label>
                            <input type="password" class="form-control" name="lg_password2" placeholder="confirm password" ng-model="data.confirmPassword">
                        </div>
                        <div class="register account_image" ng-class="{'open': mode == 2}">
                            <div class="profile_image profile_image_new">
                                <span>Choose Profile Picture</span>
                                <input type="file" onchange="angular.element(this).scope().profileImageUpload(this)" accept="x-png,gif,jpeg" />
                            </div>
                            <img style="margin-top: 20px;" id="profileImage" ng-src="{{profileimagesrc}}" ng-model="data.profileimagesrc" alt="Account Image" />
                        </div>
                        <div class="form-group login-group-checkbox register" ng-class="{'open': mode != 3}">
                            <input type="checkbox" name="lg_remember" ng-model="data.rememberMe">
                            <span ng-click="data.rememberMe = !data.rememberMe" ng-keypress="rememberKeyPress($event)">
                                <label for="lg_remember">remember</label>
                            </span>
                        </div>
                    </div>
                    <button type="button" class="login-button" ng-click="action()"><i class="fa fa-chevron-right"></i></button>
                </div>
                <div class="etc-login-form">
                    <p class="register" ng-class="{'open': mode != 3}">forgot your password? <a href="#" ng-click="setMode(3)">click here</a></p>
                    <p class="register" ng-class="{'open': mode != 2}">new user? <a href="#" ng-click="setMode(2)">create new account</a></p>
                    <p class="register" ng-class="{'open': mode != 1}">have an account? <a href="#" ng-click="setMode(1)">sign in!</a></p>
                </div>
                <div class="col-md-12 divide_socilalicons">
					<table>
						<tr style="width:100%">
							<td style="width:50%"><hr class="divider_line" ></td>
							<td >or</td>
							<td style="width:50%"><hr class="divider_line" ></td>
						</tr>
						<tr>
							<td colspan="3"><br /></td>
						</tr>
					</table>
                    
                </div>
                <div style="text-align: center">
                    <!--<div id="my-signin2" data-longtitle="true" data-onfailure="onSignInFailure" data-onsuccess="onSignIn" data-theme="light" data-width="200">

					</div>-->
					<script>
						var googleUser = {};
						//Signout of google account
						
							signOut();
						var startApp = function () {
							gapi.load('auth2', function () {
								// Retrieve the singleton for the GoogleAuth library and set up the client.
								auth2 = gapi.auth2.init({
									client_id: '648640285849-0scq8gjc86o3tavrrks8ri78210q6hmq.apps.googleusercontent.com',
									cookiepolicy: 'single_host_origin',
									// Request scopes in addition to 'profile' and 'email'
									//scope: 'additional_scope'
								});
								attachSignin(document.getElementById('customBtn'));
							});
						};

						function attachSignin(element) {
							console.log(element.id);
							auth2.attachClickHandler(element, {},
								function (googleUser) {
									console.log("GoogleUser: ", googleUser);
									onSignIn(googleUser);
									//window.location.href = "/characters";
									//document.getElementById('name').innerText = "Signed in: " +
									//	googleUser.getBasicProfile().getName();
								}, function (error) {
									alert(JSON.stringify(error, undefined, 2));
								});
						}

						function signOut() {
							if (gapi.auth2 == null)
								return;
							gapi.auth2.getAuthInstance().disconnect();
							googleUser = null;

						}
					</script>
					<style type="text/css">
						#gSignInWrapper {
							/*align-content: center;*/
							/*margin-left: 30px;*/
							width: 100%;
						}

						#customBtn:hover {
								cursor: pointer;

						}

						span.label {
								font-family: serif;
								font-weight: normal;

						}

						span.icon {
														  

						}

						span.buttonText {
							
						}
						
					</style>
					<!-- In the callback, you would hide the gSignInWrapper element osuccessful sign in -->
					<div id="gSignInWrapper">
						<div id="customBtn" class="loginBtn loginBtn--google">
							<span class="buttonText">Log in with Google</span>
						</div>
					</div>
					<div id="name"></div>
					<script>startApp();</script>
					<button onclick="SubmitLogin()" class="loginBtn loginBtn--facebook">Log in with Facebook</button> 
					<!--<button name="signInGoogle" id="signInGoogle" value="Google SignIn">Google SignIn</button>

                    <fb:login-button data-size="xlarge" data-button-type="continue_with" autologoutlink="true" perms="read_friendlists, create_event, email, publish_stream"></fb:login-button>-->
                </div>
                <div class="etc-login-form">
                </div>

            </form>
        </div>

		<div>
			By logging in you agree to the <a ng-click="showTerms();" >Terms of Service</a>
		</div>
    </div>
	<div style="max-width: 5in;margin: 0 auto;background-color:#ffffff;margin-top: 1.5em" ng-show="registersuccess">

		<table width="100%" style="padding: 0 20px">

			<tr>
				<td align="center" style="padding-top: 1em">
					<a href="https://www.facebook.com/RPG-Smith-1625592264372389" title="RPGSmith"><img width="252" height="127" title="RPGSmith" alt="RPGSmith" src="https://lh3.googleusercontent.com/QEifSn90PEjjSZ-5d3yhXoVp6ixxojV6Jo3P_lKUvvBTqxFsWmLjHllW0HrLji6hM5lgEYv3cCuWE_dDo3hzyevV_RyQZf4fA0JRHr7Y6bV0oX9Mjc3O5ZlLKzkF9sfnjkpM_YmNmLJ2SX2MmjwteXop2spQACXtsQgSOM0Sc0K94F-JFC2NcSTHwqTerHPgG-T2PSG2qINGcSdgn2m7AMkq1tSqKds5x1Ovic9auo7NkNomKTgw2WvCsoR96g9TkJRqi-viX38qbJkl3RJySoqycBoSULmZ8WaIb3gMcBM4CJFEHiVZx9a1qfpxibE_iMARM4PdP8GOiGZkqLt4NNI2rs7ojnvpXIagmS0OuUyZtXt8yw0egJWadSM_K3N_vDFE_fPt4I0RU7CDgPlD-UgjvuZ7om7c-448MOtbR4lVqFyGKyYnxxruPwtr966PpXQ3NpQpHmhfMbqSnseYJ512_aeg1ohlKpUhknsSS2WBRhTcfBo14t1f1VEyNOnd8bPx0jEUQhx4euqH8raDO6W7MxOR666SWFAlLiNJdA=w702-h353-no" /></a>
				</td>
			</tr>
			<tr>
				<td align="center">
					<div style="margin-bottom: 1em;font-size: 1.4em;font-weight: 500" mc:edit="rem_title">Email Confirmation ({{name}})</div>
				</td>
			</tr>

			<tr>
				<td align="center">
					<div style="margin-bottom: 1.5em;font-weight: 300" mc:edit="rem_notes">An Email has been sent to <strong>{{useremail}}</strong><br><br>Please check your inbox and confirm your account.</div>
				</td>
			</tr>

			<tr>
				<td align="center">
					
				</td>
			</tr>

			<tr>
				<td align="center" style="font-weight: 300;font-size: 0.8em;padding-bottom: 1em">
					Copyright &#169;2018 <a href="https://www.facebook.com/RPG-Smith-1625592264372389" title="RPGSmith" style="text-decoration: none;color: #34AADC;"><span class="RPGSmith" style="color: #D2602A;font-weight: 700;">RPG<b style="color: #000000;font-weight: 700;">&#8226;Smith</b></span></a>, LLC All rights reserved.<br>
					<div style="padding-top: 1.0em">
						<a href="https://www.facebook.com/RPG-Smith-1625592264372389" target="_blank"><img src="https://cache.addthiscdn.com/icons/v2/thumbs/32x32/facebook.png" border="0" alt="Facebook" /></a>
						<a href="https://twitter.com/RpgSmith" target="_blank"><img src="https://cache.addthiscdn.com/icons/v2/thumbs/32x32/twitter.png" border="0" alt="Twitter" /></a>
						<a href="https://plus.google.com/u/2/communities/101062066525142446219" target="_blank"><img src="https://cache.addthiscdn.com/icons/v2/thumbs/32x32/google_plusone_share.png" border="0" alt="Google+" /></a>
					</div>
				</td>
			</tr>
		</table>

	</div>

    <toaster-container class="toaster_align" style="opacity: 1.0" toaster-options="{'time-out':6000}"></toaster-container>
    

    <script>
		
		

			var appId = "315312135648885";
			window.fbAsyncInit = function () {
				
                FB.init({
                    appId: appId,
                    status: true,
                    cookie: true,
                    xfbml: true
				});
				
				//FB.Event.subscribe('auth.login', function (response) {
				//	var credentials = { uid: response.authResponse.userID, accessToken: response.authResponse.accessToken };
				//	SubmitLogin(credentials);
				//});
				
            };

            (function (d) {
                var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
                if (d.getElementById(id)) {
                    return;
                }
                js = d.createElement('script');
                js.id = id;
                js.async = true;
                js.src = "//connect.facebook.net/en_US/all.js";
                ref.parentNode.insertBefore(js, ref);
            }(document));
		
			if (angular.isUndefined(FB) != true) {
				var status = FB.getLoginStatus();
				console.log("Status: ", status);
				if (status != null && status.indexOf("connected") == 0) {
					FBlogout();
				}
			}
		//FB.getLoginStatus(function (response) {
                //    debugger;
                //    if (response.status === 'connected') {
                //        alert("user is logged into fb");
                //    }
                //    else if (response.status === 'not_authorized') { alert("user is not authorised"); }
                //    else { alert("user is not conntected to facebook"); }

                //});
		function FBlogout() {
			FB.logout(function (response) {
				// user is now logged out
			});
		}

		function SubmitLogin() {
			FB.login(function (response) {
				debugger;
				if (response.authResponse) {
					console.log('Welcome!  Fetching your information.... ');
					var credentials = { uid: response.authResponse.userID, accessToken: response.authResponse.accessToken };
					FB.api('/me', function (response) {
						console.log(response);
						angular.element('#profileImage').scope().isFBUserRegistered(credentials);
						//SubmitLogin(credentials);
						//alert(response.name);
						//  console.log('Good to see you, ' + response.name + '.');
					});
				} else {
					console.log('User cancelled login or did not fully authorize.');
				}
			});
			
		}
    </script>


    <script>
		function onSignIn(googleUser) {
			var profile = googleUser.getBasicProfile();
			console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
			console.log('Name: ' + profile.getName());
			console.log('Image URL: ' + profile.getImageUrl());
			console.log('Email: ' + profile.getEmail()); // This is null if
			console.log('Access' + googleUser.getAuthResponse().id_token);
			angular.element('#profileImage').scope().isUserRegistered(profile.getEmail(), profile.getId(), googleUser.getAuthResponse().id_token);
		}
		setTimeout(function () {
            $("#loading").css("display", "none");
        }, 1000);
    </script>
</div>